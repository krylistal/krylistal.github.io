<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>微机接口笔记 | Krylistal</title><meta name="author" content="林子轩"><meta name="copyright" content="林子轩"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="微机接口笔记第一章 绪论1.1微机与接口（1）   接口是CPU与外设之间的中转站（√） ​			 接口是主线与外设之间的中转站（√） ​             接口是处理器与外设之间的中转站（√） （2）   8086&#x2F;8088的两种工作模式及其引脚 ​             最小模式：一个微处理器产生系统中所有的总线控制信号。 ​			 最大模式：系统中有两个以上的微处理器，以8">
<meta property="og:type" content="article">
<meta property="og:title" content="微机接口笔记">
<meta property="og:url" content="http://example.com/2022/12/31/%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Krylistal">
<meta property="og:description" content="微机接口笔记第一章 绪论1.1微机与接口（1）   接口是CPU与外设之间的中转站（√） ​			 接口是主线与外设之间的中转站（√） ​             接口是处理器与外设之间的中转站（√） （2）   8086&#x2F;8088的两种工作模式及其引脚 ​             最小模式：一个微处理器产生系统中所有的总线控制信号。 ​			 最大模式：系统中有两个以上的微处理器，以8">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/12/20/liIDW2F3h8XmkHd.jpg">
<meta property="article:published_time" content="2022-12-31T10:52:01.000Z">
<meta property="article:modified_time" content="2022-12-31T10:52:35.080Z">
<meta property="article:author" content="林子轩">
<meta property="article:tag" content="未完工">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/12/20/liIDW2F3h8XmkHd.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2022/12/20/TthpMIYm6WvL4VC.jpg"><link rel="canonical" href="http://example.com/2022/12/31/%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E7%AC%94%E8%AE%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '微机接口笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2022-12-31 18:52:35'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/20/znl7XLbxSkt2q35.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/12/20/liIDW2F3h8XmkHd.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Krylistal </a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fas fa-envelope-open"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">微机接口笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-31T10:52:01.000Z" title="发表于 2022-12-31 18:52:01">2022-12-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-31T10:52:35.080Z" title="更新于 2022-12-31 18:52:35">2022-12-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3/">微机接口</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">20.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>68分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="微机接口笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="微机接口笔记"><a href="#微机接口笔记" class="headerlink" title="微机接口笔记"></a><strong>微机接口笔记</strong></h1><h2 id="第一章-绪论"><a href="#第一章-绪论" class="headerlink" title="第一章 绪论"></a>第一章 绪论</h2><h3 id="1-1微机与接口"><a href="#1-1微机与接口" class="headerlink" title="1.1微机与接口"></a>1.1微机与接口</h3><p>（1）   接口是CPU与外设之间的中转站（√）</p>
<p>​			 接口是主线与外设之间的中转站（√）</p>
<p>​             接口是处理器与外设之间的中转站（√）</p>
<p>（2）   8086&#x2F;8088的两种<u>工作模式</u>及其<u>引脚</u></p>
<p>​             <u>最小模式</u>：一个微处理器产生系统中所有的总线控制信号。</p>
<p>​			 <u>最大模式</u>：系统中有两个以上的微处理器，以8086&#x2F;8088为主处理器。控制信号由主处理器通过控制总线对各协处理器发出的控制信号进行变换和组合								后产生的</p>
<p>​			 <u>公共引脚</u>（**&#x2F;为低电平有效**）： AD15~AD0   分时复用地址&#x2F;数据线</p>
<p>​								 A 19 &#x2F;S 6 ~ A 16 &#x2F;S 3 ：传送时构成20位地址线</p>
<p>​								 MN&#x2F;MX  最小最大模式信号，1为L，0为H</p>
<p>​								 &#x2F;RD 读信号  低电平有效</p>
<p>​								 NMI 不可屏蔽的中断请求。 ↑有效，不可软件屏蔽。</p>
<p>​								 INTR：可屏蔽的中断请求线。H有效，可软件屏蔽。</p>
<p>​								 RESET：复位信号。持续4个CLK的H有效。</p>
<p>​    							 CLK：时钟信号。8086为5MHz，8088为4.77MHz。</p>
<p>​								 READY: 表示内存或外设对CPU的响应信号，高电平准备好；低电平未准备好，CPU进入等待状态</p>
<p>​    							 &#x2F;TEST：测试信号，输入。CPU执行WAIT 指令时，每隔5个CLK检测此信号。若为H则CPU空转；否则CPU结束等待状态，执行下一条指令。（WAIT指令的终止信号 指令的终止信号）</p>
<p>​								 &#x2F;BHE&#x2F;S 7 ：高字节使能&#x2F;状态信号。8086传送数据期间，若为L，表示高8位数据线正在使用（和AD 0 配合使用）。不传数据时，S 7 状态。</p>
<p>​								 &#x2F;SSO： 系统状态输出信号，仅8088使用，与IO&#x2F;&#x2F;M、DT&#x2F;&#x2F;R 配合使用表示系统总线对应的操作</p>
<p>​			最小模式引脚：&#x2F;INTA ：中断响应信号</p>
<p>​									  ALE： 地址锁存允许信号，连接 地址锁存器。CPU送地址时，该信号为H将地址锁存。</p>
<p>​									 &#x2F;DEN： 数据允许信号，连 数据总线收发器。CPU传送数据时，该信号为L可控制数据总线收发器，使其接收或发送数据。DMA方式下，该引脚浮空。</p>
<p>​									 DT&#x2F;&#x2F;R： 数据发送&#x2F; 接收信号。H表示CPU向内存或外设发送数据；L表明CPU从内存或外设接收数据。当DMA方式下，此引脚浮空。</p>
<p>​									 M&#x2F;&#x2F;IO：存储器访问或I&#x2F;O访问，输出。H表示CPU正在访问存储器；L表示CPU正在访问I&#x2F;O接口。</p>
<p>​									  &#x2F;WR：写信号。L表明CPU正在 写内存或外设。DMA方式下，此引脚为高阻态。</p>
<p>​									 HOLD： 总线保持请求信号。当其它总线主设备（如DMA控制器）要求占用总线时，通过该引脚向CPU发送请求。</p>
<p>​									 HLDA：总线保持 响应信号。当CPU收到HOLD信号后，通过该引脚发出H信号，表示 让出总线控制权</p>
<p>​			最大模式引脚： QS 1 、QS 0 ： 指令队列状态输出。不同组合表明了CPU内部指令队列的状态。</p>
<p>​										 S 0 、S 1 、S 2 ： 总线周期状态信号。 外接总线控制器 ，可产生多个不同的控制信号。</p>
<p>​										 &#x2F;LOCK： 总线锁存信号。低电平时， 不允许系统中其它总线主设备使用总线。</p>
<p>​										RQ&#x2F;GT 0 和 RQ&#x2F;GT 1 ： 总线请求信号输入&#x2F; 总线请求允许信号输出。这两个信号可提供给微处理器以外的2个总线主设备用来发出使用总线的请求，和接收微处理器对总线请求信号的应答。</p>
<h3 id="1-2微机接口概述"><a href="#1-2微机接口概述" class="headerlink" title="1.2微机接口概述"></a>1.2微机接口概述</h3><p>（1）CPU与外设之间的交互为数据和程序等各种信息输入与各类信息及运行结果的输出</p>
<p>（2）接口即为弥补CPU与外设之间差异的中转站</p>
<p>（3）微机接口的功能：<strong>I&#x2F;O地址译码与设备选择</strong>：同一时刻只允许1外设与CPU进行交互，且只有通过地址译码被选中的IO接口才可以与主线进行数据交互</p>
<p>​										<strong>信息的输入&#x2F;输出、缓冲与锁存</strong>： 输入时需要缓冲，输出时需要锁存</p>
<p>​										<strong>信号格式转换</strong></p>
<p>​										<strong>联络功能</strong>：发送“数据到”信号通知CPU取走数据、发送“传输完”信号通知外设发送新数据</p>
<p>​										<strong>中断管理</strong></p>
<p>​										<strong>其它功能</strong>： 复位、设定工作方式和工作参数等</p>
<p> （4）南北桥的定义与功能</p>
<p>​		   北桥：控制CPU与内存之间的数据交换，并控制AGP、PCI数据在其内部的传输，是主板性能的主要决定因素。北桥速度快，离CPU近。</p>
<p>​		   南桥：负责I&#x2F;0接口等一些外设接口的控制、IDE设备的控制及附加功能等等。南桥速度慢，离CPU远。</p>
<h3 id="1-3微机接口的组成"><a href="#1-3微机接口的组成" class="headerlink" title="1.3微机接口的组成"></a>1.3微机接口的组成</h3><p>​		74LS244:3态8位缓冲器，无锁存功能，一般作为总线驱动器。</p>
<p>​		74LS245:三态总线转换器，一般用于总线的电平匹配问题，为双向传送。</p>
<p>​		74LS373:三态输出的8D锁存器</p>
<p>​        74LS** 低功耗肖特基   74HC**高速低功耗CMOSS   74AS** 高功耗肖特基 74HCT** 高速低消耗CMOSS 输入为TTL电平</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">肖特基：SBD二极管。肖特基二极管是贵金属（金、银、铝、铂等）A为正极，以[N型半导体](https://baike.baidu.com/item/N型半导体/899425?fromModule=lemma_inlink)B为负极，利用二者接触面上形成的势垒具有整流特性而制成的金属-半导体器件</span><br></pre></td></tr></table></figure>

<h3 id="1-4CPU与接口的数据交换"><a href="#1-4CPU与接口的数据交换" class="headerlink" title="1.4CPU与接口的数据交换"></a>1.4CPU与接口的数据交换</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220907174736925.png" alt="image-20220907174736925" style="zoom:50%;" />

<p>CS: choice select  选择信号，选择测试端口号</p>
<p>WR：读写信号</p>
<p>LE： let enable 锁存信息</p>
<p>OE ： output enable 输出信号 低电平有效  </p>
<ul>
<li><p>CPU 与外设的几种数据交换方式</p>
</li>
<li><p>（1） 无条件传送（同步传送）：程序简单，外设已准备好，无需查询外设状态，直接使用传送数据</p>
<p>（2）条件传送： 传送前查询外设状态 仅准备好才交换数据，效率低下</p>
<p>（3）中断方式： 由外设向CPU发送信息，当且仅当外设主动发送中断请求，且符合中断优先级时，CPU才中断当前程序来对外设进行服务。提高了实时性，但硬件复杂，是CPU通过程序来控制传送数据，适用于较少次数请求中断的外设，不适用于高速批量传送数据的场合。</p>
<p>（4）DMA（Direct Memory Access）方式：数据传输不通过CPU，而设置DMA控制器在外设与内存之间。当DMA需要进行数据传输时，DMA向CPU提出总线请求，CPU将总线传输控制权给DMA。DMA方式下，除CPU外，DMAC也是主控设备。减轻了CPU负担，开销大，适用于批量数据的高速传输。</p>
</li>
</ul>
<h3 id="第一章结构提纲"><a href="#第一章结构提纲" class="headerlink" title="第一章结构提纲"></a>第一章结构提纲</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220907180559629.png" alt="image-20220907180559629"></p>
<p>第一章思考题</p>
<ol>
<li><p>微机系统的硬件结构组成是什么样的？</p>
<p>解：硬件系统由5部分组成：1、运算器，主要功能是对数据和信息进行运算和加工；2、控制器，是计算机的神经中枢，指挥全机中各个部件自动协调工作；3、存储器，是计算机的记忆系统，不仅可以保存信息，还能接受计算机系统内不同的信息并对保存的信息进行读取；4、输入设备，用于把原始数据和处理这些数的程序输入到计算机中；5、输出设备，用于接收计算机数据的输出显示、打印、声音、控制外围设备操作等。</p>
</li>
<li><p>微机接口的软硬件组成是怎么样的？</p>
<p>解：硬件接口也称为硬设备接口，主要指与外设备连接时的电缆接口、蓝牙接口、红外接口等；软件接口，是通过计算机语言实现两个设备之间的数据通讯连接，实现信息交换。</p>
</li>
<li><p>请分析CPU与接口之间最常用的三种方式的工作原理，并比较它们的工作效率</p>
</li>
</ol>
<p>  解：查询方式、中断方式和DMA方式 ，比较看上述笔记。</p>
<h2 id="第二章-I-x2F-O端口地址译码技术"><a href="#第二章-I-x2F-O端口地址译码技术" class="headerlink" title="第二章 I&#x2F;O端口地址译码技术"></a>第二章 I&#x2F;O端口地址译码技术</h2><h3 id="2-1I-x2F-O端口地址"><a href="#2-1I-x2F-O端口地址" class="headerlink" title="2.1I&#x2F;O端口地址"></a>2.1I&#x2F;O端口地址</h3><p>存在两种I&#x2F;O端口编址方式：统一编址、独立编址</p>
<p>统一编址：I&#x2F;O端口被当成普通内存单元看待，I&#x2F;O端口与内存单元 统一进行地址分配，使用 统一的指令进行访问。</p>
<p>独立编址：I&#x2F;O端口与内存单元有 各自独立的地址空间，访问I&#x2F;O端口使用专门的I&#x2F;O指令 指令。</p>
<ul>
<li><p>独立编址下的I&#x2F;O指令    (传输 一个字节时使用AL；传输 一个字时使用AX)</p>
</li>
<li><ul>
<li><p>直接寻址    端口地址 ≤ 0FFH</p>
<p>输入：IN AL&#x2F;AX,port   </p>
<p>输出：OUT port,AL&#x2F;AX</p>
</li>
</ul>
</li>
<li><ul>
<li><p>间接寻址 端口地址 &gt; 0FFH</p>
<p>输入： MOV DX,port</p>
<p>​			 IN AL&#x2F;AX,DX</p>
<p>输出： MOV DX,port</p>
<p>​		OUT DX,AL&#x2F;AX</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-2I-x2F-O端口地址分配"><a href="#2-2I-x2F-O端口地址分配" class="headerlink" title="2.2I&#x2F;O端口地址分配"></a>2.2I&#x2F;O端口地址分配</h3><ul>
<li>系统配置占用了的端口地址不能使用。</li>
<li>计算机厂家声明保留的地址不能使用。</li>
<li>用户可使用300~31FH的地址。但为了避免与其它用户开发的接口卡发 生冲突，最好采用DIP开关 开关进行地址设置。</li>
</ul>
<h3 id="2-3I-x2F-O端口地址译码"><a href="#2-3I-x2F-O端口地址译码" class="headerlink" title="2.3I&#x2F;O端口地址译码"></a>2.3I&#x2F;O端口地址译码</h3><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914161610478.png" alt="image-20220914161610478"  />

<p>&#x2F;CS：由地址线和控制线进行逻辑组合</p>
<p>&#x2F;IOR：控制信号，读信号</p>
<p>&#x2F;IOW：控制信号，写信号</p>
<p>&#x2F;AEN：地址使能信号，高电位表示DMAC传输，低电位表示CPU传输</p>
<ul>
<li>片选逻辑（地址线分为高低两部分，分别用于片间和片内寻址）<ul>
<li>片间寻址：高位地址线与控制信号结合，产生片选信号&#x2F;CS，以选中接口芯片。<br>Ø 通常都由接口芯片 外部的译码电路来完成。</li>
<li>片内寻址：位地址线与控制信号连到I&#x2F;O接口芯片，用以选择内部端口。<br>Ø 通常由接口芯片 内部的译码电路来完成。<br>Ø 用于片内寻址的 低位地址线条数取决于接口内的端口数目。低位地址线数 &#x3D; <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914162028635.png" alt="image-20220914162028635" style="zoom: 33%;" />。</li>
</ul>
</li>
</ul>
<p>常用的两种译码方式：</p>
<ul>
<li><p>门电路译码：与或非门，门电路集成芯片（ 74LS04：反相器（6门集成）， 74LS08：与门（4门集成）， 74LS20：4输入与非门（2门集成）， 74LS30：8输入与非门（1门集成），74LS32：2输入或门（4门集成））</p>
</li>
<li><p>译码器译码：多端口时常用专用译码器译码，常用译码器（ 74LS138：3-8译码器，74LS139：双2-4译码器，74LS154：4-16译码器）</p>
<p>【例2-4】已知并口芯片8255A内有4个端口，片选信号CS低有效。试用74LS138设计一个译码电路，使该芯片的4个端口地址为 2F0H ~ 2F3H。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914162519271.png" alt="image-20220914162519271"  />

<p>【例2-5】设计一个译码电路，要求产生2A8H~2AFH共8个端口的选通信号。</p>
<p>提示：题目并没有说是一个芯片，所以只需要做一个译码器用来选择端口</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914162613496.png" alt="image-20220914162613496"></p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914162647690.png" alt="image-20220914162647690"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914162708686.png" alt="image-20220914162708686"></p>
<p>作业题：分析并阐述74LS04&#x2F;08&#x2F;20&#x2F;30&#x2F;32的功能，并画出各芯片的内部逻辑结构图及真值表。</p>
<p>74LS04: 内部逻辑结构及真值表 <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914173350293.png" alt="image-20220914173350293" style="zoom:50%;" /><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914173733962.png" alt="image-20220914173733962"></p>
<p>74LS08</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914173917496.png" alt="image-20220914173917496"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914173925513.png" alt="image-20220914173925513"></p>
<p>74LS20<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914174032667.png" alt="image-20220914174032667"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914174039533.png" alt="image-20220914174039533"></p>
<p>74LS30<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914174100123.png" alt="image-20220914174100123"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914174109939.png" alt="image-20220914174109939"></p>
<p>74LS32</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914174125239.png" alt="image-20220914174125239"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220914174129898.png" alt="image-20220914174129898"></p>
<p>I&#x2F;O端口地址的可选式译码</p>
<p>为了使端口具有一定的可变性，可以根据要求改变端口的地址</p>
<ul>
<li>比较器</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220919193400626.png" alt="image-20220919193400626"></p>
<p>当D7<del>0&#x3D;A9</del>3时，才进行写入</p>
<p>所以可以对指定的端口进行预配置</p>
<ul>
<li><p>地址开关</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220919193757806.png" alt="image-20220919193757806"></p>
<p>利用开关来与比较器的结合来完成自定义的地址选择与预配置</p>
</li>
<li><p>跳线开关<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220919193916443.png" alt="image-20220919193916443"></p>
<p>每个输入可以接或者不接，有两种选择。10位地址有2^10次个选择</p>
</li>
</ul>
<h3 id="第二章结构提纲"><a href="#第二章结构提纲" class="headerlink" title="第二章结构提纲"></a>第二章结构提纲</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220919194702396.png" alt="image-20220919194702396"></p>
<h2 id="第三章-定时-x2F-计数技术"><a href="#第三章-定时-x2F-计数技术" class="headerlink" title="第三章 定时&#x2F; 计数技术"></a>第三章 定时&#x2F; 计数技术</h2><h3 id="3-1定时-x2F-技术基本概念"><a href="#3-1定时-x2F-技术基本概念" class="headerlink" title="3.1定时&#x2F;技术基本概念"></a>3.1定时&#x2F;技术基本概念</h3><p><u>定时和计数</u>：实质上都是 计数 。定时是通过 记录高精度晶振的脉冲个数 ，输出准确的时间间隔。</p>
<p>微机系统中的定时分为以下两种：</p>
<p>内部定时：是计算机本身运行的 时间基准或 时序关系。计算机的每个操作都严格按照固定的时间节拍来进行</p>
<p>外部定时：外设与CPU，或外设与外设之间的时间基准和时序关系。</p>
<p>微机中的定时方法：</p>
<p>▲ 软件定时：通过软件编程， 循环执行一段程序来实现。</p>
<p>▲不可编程的硬件定时：采用 分频器、 单稳电路或简易定时电路来实现。</p>
<p>▲可编程的硬件定时：用 可编程定时器芯片实现，</p>
<h3 id="3-2-8253-x2F-8254计时器及工作方式"><a href="#3-2-8253-x2F-8254计时器及工作方式" class="headerlink" title="3.2  8253&#x2F;8254计时器及工作方式"></a>3.2  8253&#x2F;8254计时器及工作方式</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921202219831.png"></p>
<p>COUNTER#0 ：16位计数初值寄存器</p>
<p>COUNTER#1 ：16位-1计数器</p>
<p>COUNTER#2 ：16位当前值锁存寄存器</p>
<p>8253&#x2F;8254 的每个计数器有6种工作方式：</p>
<ul>
<li><p>方式0——计数期间低电平输出（GATE高电平时计数）</p>
<ul>
<li><p>计数过程</p>
<p>▲ 写入 方式字0后，WR的<u>上升沿</u> ↑使OUT信号变低。<br>▲ 写入 计数初值后，WR的 <strong>↑</strong>将初值写入初值寄存器，在下一个CLK <strong>↓</strong>，将计数初值写入减1计数器。<br>▲ 之后每个CLK ↓ ， 计数减1。减为0时，OUT变高。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921203046438.png" alt="image-20220921203046438"  />
</li>
<li><p>门控信号</p>
<p>▲ GATE为高时允许计数；为低时 暂停计数，其计数值保持。当GATE再次变高时，计数器从暂停处 继续计数。<br>▲ GATE信号的变化不影响OUT信号的状态。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921203119791.png" alt="image-20220921203119791"></p>
</li>
<li><p>重新计数</p>
<p>计数期间，若再次写入计数初值，则计数器 立即按 新的初值重新计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921203140891.png" alt="image-20220921203140891"></p>
<p>总结：写入时输出端为低电平，第二次写入时遇到CLK下降沿时开始计数，计数到0时输出端为高电平；门控信号对输出端为低电平时<u><strong>暂停</strong></u>计数，高电平时继续计数；当计数过程中再次写入时，以第二次写入的值开始重新计数。</p>
</li>
</ul>
</li>
<li><p>方式1——计数期间低电平输出（GATE上升沿重新计数）</p>
<ul>
<li><p>计数过程</p>
<p>▲ 写入方式字1后，WR的 ↑ 使OUT信号变高。<br>▲ 写入初值后，若无GATE ↑，则OUT持续为高；若有GATE↑，则在GATE ↑ 后的下一个CLK ↓ ，OUT变低。<br>▲ 之后每个CLK ↓，计数减1。减为0时，OUT变高。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921204015170.png" alt="image-20220921204015170"></p>
</li>
<li><p>门控信号</p>
<p>▲ 计数期间，若GATE信号又出现 ↑，则计数器 重新装入初值，开始新的计数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921204344183.png" alt="image-20220921204344183"></p>
</li>
<li><p>重新计数</p>
<p>▲ 计数期间，若重新写入初值， 须等当前计数值 计满到0，且GATE 再次出现 ↑时 ，才按新的初值重新计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921204422052.png" alt="image-20220921204422052"></p>
<p>总结：输出端只有在写入方式1与正在计数时（除0外）为低电平，计数的启动需要Gate门的上升沿驱动；方式1门驱动与方式0相同；</p>
<p>重新计数必须得上一次计数结束且Gate门再次出现上升沿时才会重新计数。</p>
</li>
</ul>
</li>
<li><p>方式2——周期性输出负脉冲</p>
<ul>
<li><p>计数过程</p>
<p>▲ 写入方式字2后，WR的 ↑ 使OUT信号变高。<br>▲ 写入初值后，在CLK ↓进行减1计数。 减为1 时，OUT变低 变低并维持一个周期，然后又变高，并 自动装入初值重新计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921205013786.png" alt="image-20220921205013786"></p>
</li>
<li><p>门控信号</p>
<p>▲ GATE为高，允许计数；为低， 终止计数。待GATE恢复为高后，计数器将 从初值重新计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921205032474.png" alt="image-20220921205032474"></p>
</li>
<li><p>重新计数</p>
<p>▲ 计数期间，若重新写入初值，则不影响正在进行的计数过程，必须等到计数器减到 等到计数器减到1之后，才 之后，才 自动 装入新的初值，并按照新的初值进行计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921205048788.png" alt="image-20220921205048788"></p>
<p>总结：写入方式2时，输出端变为高电平，直到计数结束（变成0）时，输出端变为低电平，并且**<u>自动开始下个周期</u>**；当Gate为低电平时，停止计时，下次计数以初始值重新开始计时；在一次计数过程中写入新的初值时，必须得等待上一次的计数结束。该方式能连续工作，且输出固定频率的脉冲，因此称之为 <strong><u>频率发生器 或 分频器</u></strong> 。</p>
</li>
</ul>
</li>
<li><p>方式3——周期性输出方波</p>
<ul>
<li><p>计数过程</p>
<ul>
<li><p>当初值n为偶数时</p>
<p>▲ 写入方式字后，OUT信号变高。<br>▲ 写入初值后开始减1计数；减到 n&#x2F;2 时，OUT变低继续计数；减到0时，OUT变高，并自动装入初值重新计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921210037220.png" alt="image-20220921210037220"></p>
<p>·OUT 端连续输出 占空比为1&#x2F;2的方波。<br>·占空比（ Ducty Cycle ）：脉冲序列中，正脉冲的持续时间与脉冲总周期的比值。</p>
</li>
<li><p>当初值n为奇数时</p>
<p>▲ 写入方式字后，OUT信号变高。<br>▲ 写入初值后开始减1计数；减到 (n-1)&#x2F;2 时，OUT变低继续计数；减到0时，OUT变高并自动装入初值，重新计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921210127471.png" alt="image-20220921210127471"></p>
</li>
</ul>
</li>
<li><p>门控信号</p>
<p>与方式2相同，同样要区分初值的奇偶性</p>
</li>
<li><p>重新计数</p>
<p>与方式2相同，同样要区分初值的奇偶性</p>
<p>总结：大体上与方式2相同但是方式3不等到减为1，而是减到约初值的一半，保持低电平；减到0时再变高，如此反复。因此，可输出连续方波，故称为 方波发生器</p>
<p>方式3的实际运行与上述的电平图线不同</p>
<p>偶数情况下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921211512348.png" alt="image-20220921211512348"></p>
<p>奇数情况下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921211857829.png" alt="image-20220921211857829"></p>
</li>
</ul>
</li>
<li><p>方式4—— 软件触发输出单脉冲</p>
<ul>
<li><p>计数过程</p>
<p>▲ 写入方式字4后，OUT信号变高。<br>▲ 写入初值后，进行减1计数。减为0时，OUT端输出一个CLK周期的负脉冲，然后恢复为高电平。<br>▲ 不能自动装入初值。要想启动下一次计数，需重新写入初值，由 软件触发计数器开始工作。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921210234530.png" alt="11"></p>
</li>
<li><p>门控信号</p>
<p>▲ GATE高电平时，允许计数；为低则 终止计数。待GATE恢复为高后，计数器将从 初值重新进行计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212059461.png" alt="image-20220921212059461"></p>
</li>
<li><p>重新计数</p>
<p>▲ 计数期间，若重新写入初值，则不会影响正在进行的计数过程，必须等到计数器减到 必须等到计数器减到0之后，才装入新的初 之后，才装入新的初<br>值，并按照新的初值进行计数。<br>▲ 计数完毕后 若无软件再次触发，计数器将停止工作。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212118809.png" alt="image-20220921212118809"></p>
</li>
</ul>
</li>
<li><p>方式5—— 硬件触发输出单脉冲</p>
</li>
<li><p>计数过程</p>
<p>▲ 写入方式字5后，OUT信号变高。<br>▲ 写入初值后并不立即计数，而是等GATE有  ↑才开始计数。减为0时，OUT端输出一个周期的负脉冲，然后变高。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212140679.png" alt="image-20220921212140679"></p>
</li>
<li><p>门控信号</p>
<p>▲ 计数过程中或计数结束后，若GATE再次出现上升沿，则计数器装入初值重新进行计数。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212204662.png" alt="image-20220921212204662"></p>
</li>
<li><p>重新计数</p>
<p>与方式5相同</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212322518.png" alt="image-20220921212322518"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212331563.png" alt="image-20220921212331563"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212342918.png" alt="image-20220921212342918"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220921212352319.png" alt="image-20220921212352319"></p>
<h3 id="3-3-8253-x2F-8254编程与应用"><a href="#3-3-8253-x2F-8254编程与应用" class="headerlink" title="3.3 8253&#x2F;8254编程与应用"></a>3.3 8253&#x2F;8254编程与应用</h3><p>（1）方式字</p>
<ul>
<li>指定使用哪个计数器。</li>
<li>指定某个计数器的工作方式。</li>
<li>指定计数初值的长度、装入顺序以及计数值的码制。</li>
<li>指定是向计数器 写入初值，还是 锁存其当前计数值。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220926194147624.png" alt="image-20220926194147624"></p>
<p>​																													<strong>方式字的格式</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220926194215445.png" alt="image-20220926194215445"></p>
<ul>
<li>计数器的选择</li>
</ul>
<p>​		D7D6：00-计数器0；01-计数器1；10-计数器2；11-8253并未用到</p>
<ul>
<li>读写格式</li>
</ul>
<p>​        D5D4：00-锁存当前值；01-写入低8位，高8位默认为0；10-写入高8位，低8位默认为0；11-高8位与低8位都写，先写低8位，再写高8位</p>
<ul>
<li>工作方式</li>
</ul>
<p>​		D3D2D1：000-方式0计数；001方式1计数；X10-方式2计数；X11-方式3计数；100-方式4计数；101-方式5计数</p>
<ul>
<li>数制</li>
</ul>
<p>​		D0：0-以二进制写入；1-以8421BCD码写入</p>
<p>计数初值：8253&#x2F;8254是减1计数器， 计数初值决定了定时的长短。l定时时间 T out &#x3D;计数初值n × 计数时钟周期 T CLK ，故</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220926195302677.png" alt="image-20220926195302677"></p>
<p>8253&#x2F;8254 初始化编程与应用</p>
<p>写方式字的端口号A1A0编号为11</p>
<p>写计数器0的端口号A1A0编号为00</p>
<p>写计数器1的端口号A1A0编号为01</p>
<p>写计数器2的端口号A1A0编号为10</p>
<p>​																												<strong>具体的操作对应的字段编码</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20220926195741700.png" alt="image-20220926195741700"></p>
<h2 id="第五章-中断技术"><a href="#第五章-中断技术" class="headerlink" title="第五章 中断技术"></a>第五章 中断技术</h2><h3 id="5-1-中断技术概述"><a href="#5-1-中断技术概述" class="headerlink" title="5.1 中断技术概述"></a>5.1 中断技术概述</h3><p>▲中断方式下，CPU无需完全服务于某个外设，效率高。</p>
<p>▲当出现某些异常或某外设有请求时，CPU<strong>暂停</strong>正在执行的程序，<strong>转去</strong>执行某一特定的程序，执行完后再<strong>返回</strong>原来的程序处继续执行。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011192551688.png" alt="image-20221011192551688"></p>
<h4 id="5-1-1-中断的常用术语"><a href="#5-1-1-中断的常用术语" class="headerlink" title="5.1.1 中断的常用术语"></a>5.1.1 中断的常用术语</h4><p>1、中断</p>
<p>▲指CPU正在执行某程序时，由于出现了某些异常或外设提出了某种请求，CPU<strong>暂停</strong>当前程序，<strong>转去</strong>处理异常或外设请求的程序，执行完后再<strong>返回</strong>原来被终止的程序处继续执行。该过程称为中断。</p>
<p>2、主程序</p>
<p>▲未发生中断时，CPU正在执行的程序称为主程序。</p>
<p>3、中断服务程序 ISR</p>
<p>▲处理中断事件的程序，又称中断子程序。</p>
<p>▲不同的中断对应不同的ISR。</p>
<p>4、断点</p>
<p>▲中断时，主程序中被终止指令的<strong>下一条指令的地址</strong>。</p>
<p>▲CPU转去执行ISR时，断点被<strong>压入栈</strong>中进行保护；ISR执行完毕后，CPU通过<strong>出栈</strong>操作从栈顶获得中断断点，确保能返回到主程序处继续执行。</p>
<p>5、中断源</p>
<p>▲引起中断的事件或设备。</p>
<p>▲<strong>内部中断</strong>：在CPU的内部产生。例：CPU执行程序时遇到的特殊情况，如：除法错。</p>
<p>▲<strong>外部中断</strong>：在CPU的外部产生。例：外设提出的中断，如电源故障。</p>
<p>6、中断类型号</p>
<p>▲微机系统中有多个中断源。为便于区分，为每个中断源分配一个<strong>编号</strong>，即中断类型号。</p>
<p>7、中断接口</p>
<p>▲当中断源向CPU发中断请求时，需由一个电路来进行<strong>管理</strong>，如：接收中断请求、屏蔽&#x2F;打开中断请求、中断优先级排队、中断嵌套和中断结束等。实现中断管理的<strong>逻辑电路</strong>称为中断接口。</p>
<p>▲本章使用<strong>8259A</strong>可编程中断控制器对系统的中断进行管理。</p>
<p>​	可以分为：软件辨别接口与硬件辨别接口。</p>
<p>8、中断识别</p>
<p>▲指CPU<strong>确定</strong>哪一个中断源发出中断请求的过程。</p>
<p>▲<strong>目的</strong>：找到该中断源所对应的中断服务程序的<strong>入口地址</strong>，转去进行处理。</p>
<p>▲中断识别的2种方法：</p>
<p>​		★<strong>查询法</strong>：采用软件查询技术来确定发出中断请求的中断源。</p>
<p>​		★<strong>硬件法</strong>：由可编程中断控制器来提供中断类型号。</p>
<p>9、中断向量和中断向量表</p>
<p>▲中断向量：指中断服务程序的<strong>入口地址</strong>。</p>
<p>​		★每个ISR都有一个<strong>确定</strong>的入口地址。</p>
<p>​		★入口地址 &#x3D; 段基址CS ： <strong>偏移地址</strong>IP，共4个字节。</p>
<p>▲中断向量表：<strong>将系统中所有的中断向量集中起来</strong>，<strong>按中断类型号从小到大的顺序</strong>存放在内存某区域。该存储区域称为中断向量表。</p>
<p>​		★PC机中共有256个中断（0~255），每个中断向量占4个字节，共占1KB的存储区域。</p>
<p>​		★用 0~3FFH 的内存单元存储中断向量表。</p>
<p>​																																	<strong>中断向量表</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011193848658.png" alt="image-20221011193848658"></p>
<h4 id="5-1-2-中断过程"><a href="#5-1-2-中断过程" class="headerlink" title="5.1.2 中断过程"></a>5.1.2 中断过程</h4><p>1、中断源请求中断</p>
<p>▲外设发出中断请求时，中断接口电路需设置<strong>中断请求触发器</strong>，<strong>保持</strong>外设的中断请求信号，直到CPU响应该中断后才<strong>清除</strong>它。</p>
<p>▲中断接口电路应设置<strong>中断屏蔽寄存器</strong>，CPU可通过对其进行设置，使得某些中断源的中断请求不能提交到CPU。</p>
<p>中断屏蔽寄存器与接口中的中断请求位相结合来判断该外设是否能发生中断</p>
<p>高电位表示接收屏蔽，该外设中断失效，低电位表示可以接收中断。</p>
<p>2、<strong>中断判优</strong></p>
<p>▲由于同一时刻可能会有多个中断源同时请求中断服务，因此接口电路需对这些中断源进行<strong>优先级判别</strong>和<strong>优先级排队</strong>。这个过程称为中断判优。</p>
<p>▲CPU按照优先级的高低顺序来响应中断。</p>
<p>3、<strong>中断响应</strong></p>
<p>▲收到中断请求后，若CPU满足响应条件，则进入中断响应周期。</p>
<p>▲CPU响应中断的<strong>条件</strong>：</p>
<ul>
<li>CPU当前指令执行结束。（在执行指令过程中不能执行中断）</li>
<li>没有更高级的中断请求在执行。（优先级的判断）</li>
<li>CPU处于开中断状态 (IF&#x3D;1)。可用指令改变IF的状态：STI开中断；CLI关中断。</li>
</ul>
<p>▲中断响应周期需完成的操作(CPU硬件自动完成)</p>
<ul>
<li><p>清IF和TF标志，以免在<strong>响应过程中</strong>被新的中断源中断，破坏了当前中断处理的现场。（表示不可以发生中断）</p>
</li>
<li><p>将FLGAS寄存器和中断断点 (CS:IP) 压栈保存。</p>
</li>
<li><p>查找中断向量表，获得ISR的入口地址，转去执行ISR。</p>
</li>
</ul>
<p>​																								<strong>中断响应及处理过程示意图</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011195120282.png" alt="image-20221011195120282"></p>
<p>4、<strong>中断服务</strong></p>
<p>CPU转入ISR后，需做以下几件事情：</p>
<p>①<strong>保护现场</strong>：ISR将要用到的寄存器<strong>压栈</strong>，以免其数据破坏。</p>
<p>②<strong>开中断</strong>：以便在执行ISR时，能响应更高级的中断请求。（服务与③）</p>
<p>③<strong>中断处理</strong>：处理中断请求所要求的操作。</p>
<p>④<strong>关中断</strong>：保证在恢复现场时不被新的中断打断。（服务与⑤）</p>
<p>⑤<strong>恢复现场</strong>：在ISR结束前，执行<strong>出栈</strong>操作，恢复各寄存器的内容，以便主程序正确执行。</p>
<p>⑥<strong>开中断</strong>：保证返回主程序后仍能响应中断。</p>
<p>⑦<strong>中断返回</strong>：ISR的最后一条指令为<strong>IRET</strong>，它将IP、CS和FLAGS的内容依次弹出，以便恢复到主程序的断点处。</p>
<h4 id="5-1-3-中断管理"><a href="#5-1-3-中断管理" class="headerlink" title="5.1.3 中断管理"></a>5.1.3 中断管理</h4><p>1、<strong>中断源识别</strong></p>
<p>▲PC机内有多个中断源，CPU收到中断请求后，需识别是哪一个中断源发出了中断请求信号，以便执行相应的中断服务程序。</p>
<p>▲中断源识别的两种方法：</p>
<ul>
<li><p><strong>软件查询</strong>：CPU逐个查询各中断源的状态，从而确定是哪个设备发出了中断请求。</p>
</li>
<li><p><strong>硬件处理</strong>：中断<strong>接口电路</strong>将要响应的<strong>中断类型号</strong>送给CPU。</p>
</li>
</ul>
<p><strong>2、</strong> <strong>中断的优先级排队</strong></p>
<p>▲当有多个中断源同时请求中断时，由于<strong>CPU</strong>在同一时刻只能响应并处理一个中断请求，因此，需根据中断的性质及轻重缓急对中断源进行优先级排队。</p>
<p>▲CPU先响应优先级高的中断请求。高优先级的中断请求可中断低优先级的中断服务。</p>
<p>▲优先级排队的方法：</p>
<ul>
<li>软件查询法</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011195826886.png" alt="image-20221011195826886"></p>
<p>​		-  优点：实现简单，节省硬件。</p>
<p>​		-  缺点：</p>
<p>​			<strong>中断源较多时，查询程序较长</strong>，由查询转入相应的中断服务程序入口需要的时间较长。</p>
<p>​			<strong>查询的先后顺序决定了中断的优先级顺序</strong>：先被查询的中断，优先级最高。</p>
<ul>
<li>硬件菊花链排队法</li>
</ul>
<p>在每个外设的接口上<strong>接一个逻辑电路</strong>，这些电路构成一个链来实现<strong>中断应答信号的控制</strong>，称为菊花链。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011195947052.png" alt="image-20221011195947052"></p>
<p><strong>中断请求</strong>：设备A、B、C通过接口发出中断请求：1有请求，0无请求。只要有一个设备发出请求，则 INTR &#x3D; 1。</p>
<p><strong>中断响应</strong>：若CPU允许中断，则发INTA中断响应信号。该信号先送给外设A的菊花链电路。</p>
<p>​	若A没有请求，则它输出的INTA仍为0，继续往下传。</p>
<p>​	若A有中断请求，则经过或门时，由于其中断请求为1，故输出的INTA为1，使得后继的中断得不到响应。</p>
<p><strong>特点：越<strong><strong>靠近</strong></strong>CPU****的外设，优先级越高。</strong></p>
<ul>
<li>可编程中断控制器排队法</li>
</ul>
<p>​	早期的PC多采用软件查询或菊花链法。</p>
<p>​	目前的PC一般采用专用的可编程控制器芯片来完成中断优先级的排队管理，如8259A。</p>
<p><strong>3、</strong> <strong>中断嵌套</strong></p>
<p>▲CPU正在处理某个中断的过程中，若出现了更高级的中断请求，则CPU停止执行级别低的ISR，而转去处理级别更高的中断。等高级别的中断处理完后，再返回原来的低级中断继续执行，依次类推，直到返回主程序。这种方式称为<strong>多重中断</strong>或<strong>中断嵌套</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011200107658.png" alt="image-20221011200107658"></p>
<h3 id="5-2-8086-x2F-8088-微机中的系统"><a href="#5-2-8086-x2F-8088-微机中的系统" class="headerlink" title="5.2 8086&#x2F;8088 微机中的系统"></a>5.2 8086&#x2F;8088 微机中的系统</h3><h4 id="5-2-1-中断的类型"><a href="#5-2-1-中断的类型" class="headerlink" title="5.2.1 中断的类型"></a>5.2.1 中断的类型</h4><p>​	8086&#x2F;8088用<strong>8****位</strong>二进制数表示一个<strong>中断类型号</strong>，可区分256个中断源。</p>
<p>​	8086&#x2F;8088中断系统的结构</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011200226767.png" alt="image-20221011200226767"></p>
<ul>
<li><p>外部中断<strong>：由CPU外的硬件产生，又称</strong>硬件中断**。有以下2种：</p>
<p> <strong>①</strong> <strong>NMI</strong>（不可屏蔽中断）</p>
</li>
</ul>
<p>▲↑触发，不受IF标志位控制。只要有NMI ↑，CPU在当前指令结束后，立刻响应该中断。</p>
<p>▲中断类型号为2<strong>，CPU</strong>无需发中断应答即可立即执行2号中断的ISR。</p>
<p>▲外部中断中，<strong>NMI</strong>的优先级最高<strong>，用于电源掉电、时钟错误等紧急情况，一般</strong>用户不能使用。</p>
<p> <strong>②</strong> <strong>INTR</strong>（可屏蔽中断、来源于外设）</p>
<p>▲高电平触发，必须保持到当前指令结束。</p>
<p>▲<strong>受</strong>IF标志位控制。STI：允许中断；CLI：禁止中断。</p>
<p>▲<strong>中断类型号为</strong> <strong>08~0FH</strong> <strong>和</strong> <strong>070H~077H</strong>。当中断允许时，CPU<strong>发出中断应答</strong>信号&#x2F;INTA，并从8259A获得中断源的中断类型码。</p>
<ul>
<li><strong>内部中断</strong>： 由CPU执行指令产生的中断，又称<strong>软件中断</strong>。</li>
</ul>
<p> <strong>①</strong> <strong>除法错</strong></p>
<p>▲当除数为0，或对带符号数进行除法运算时所得结果超出规定的范围，则CPU自动产生该中断。</p>
<p>▲中断<strong>类型号为</strong>0。</p>
<p> <strong>②</strong> <strong>单步中断</strong></p>
<p>▲<strong>调试程序</strong>时用。CPU每执行一条指令，就进入一次中断。功能：<strong>显示</strong>出CPU内部各寄存器的内容。</p>
<p>▲受TF标志位控制。<strong>TF&#x3D;1</strong>时，CPU自动产生单步中断。</p>
<p>▲中断类型号为1。</p>
<p> <strong>③</strong> <strong>断点中断</strong> <strong>INT</strong> <strong>3</strong></p>
<p>▲单字节中断指令，类型号为3。</p>
<p>▲调试时可在<strong>程序关键处</strong>设置断点。当程序执行到该指令处，转去执行一个断点中断。功能：<strong>显示</strong>CPU内部各寄存器的内容，并给出一些提示信息。</p>
<p> <strong>④</strong> <strong>溢出</strong>中断 <strong>INTO</strong></p>
<p>▲单字节中断指令。类型号为4。</p>
<p>▲该指令常跟<strong>在带符号数运算指令之后</strong>。若标志寄存器的OF&#x3D;1，则执行溢出中断，其中断服务程序给出<strong>出错信息</strong>。</p>
<p> <strong>⑤</strong> <strong>用户定义的软件中断</strong></p>
<p>▲双字节中断指令INT n，由用户定义，类型号为n。</p>
<p>▲<strong>不可被屏蔽</strong>。CPU<strong>不发响应</strong>信号，中断控制器<strong>不提供中断类型号</strong>。</p>
<ul>
<li><p><strong>内、外中断的优先级次序</strong></p>
<p>▲8086&#x2F;8088系统中，除单步中断外，所有<strong>内部中断的优先级均高于外部中断</strong>。</p>
<p>▲除单步中断外，所有内部中断都不能被屏蔽。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011201133052.png" alt="image-20221011201133052"></p>
</li>
</ul>
<h4 id="5-2-2-中断向量表"><a href="#5-2-2-中断向量表" class="headerlink" title="5.2.2 中断向量表"></a>5.2.2 中断向量表</h4><p>8086&#x2F;8088系统支持256个中断源，各个中断源用不同的<strong>中断类型号</strong>标识，即：0~255。</p>
<p>每个中断源都有相应的ISR，每个ISR都有不同的<strong>入口地址（又称中断向量）</strong>。</p>
<p>每个入口地址由4个字节标识：</p>
<p>▲低2个字节：存放中断入口的<strong>偏移地址（IP）</strong>。</p>
<p>▲高2个字节：存放中断入口的<strong>段基址（CS）</strong>。</p>
<p>系统各个中断入口地址的集合形成<strong>中断向量表</strong>。共占1KB空间，地址范围 0~3FFH（<strong>DS&#x3D;0</strong>）。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011201233164.png" alt="image-20221011201233164" style="zoom:50%;" />

<ul>
<li><p>由于0~255号中断的入口地址依次<strong>连续排列</strong>，故：已知某中断的类型号为n，则其对应的 ISR入口地址在中断向量表中的存储位置为4n。</p>
</li>
<li><p>依次从4n处取出4个字节的内容，低2个字节送入偏移地址IP，高2个字节送入段地址CS，即：</p>
</li>
</ul>
<p>​				▲(IP) ← [4n+1, 4n]。</p>
<p>​				▲(CS) ← [4n+3, 4n+2] 。</p>
<ul>
<li>获得了中断的入口地址，即可转入相应的 ISR 执行中断处理过程。</li>
</ul>
<p>【例5-1】已知类型号为15H的中断，其 ISR 存放在内存的5678H: 0100H ~ 5678H: 0123H单元。画出该中断的中断向量在中断向量表中的位置和内容。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221011201309336.png" alt="image-20221011201309336" style="zoom:50%;" />

<h4 id="5-2-3中断向量的设置与修改"><a href="#5-2-3中断向量的设置与修改" class="headerlink" title="5.2.3中断向量的设置与修改"></a>5.2.3<strong>中断向量的设置与修改</strong></h4><p>​	在使用中断前，我们需要将中断向量地址位写入中断向量表。在写之前，要关闭中断，避免在设置或修改过程中被中断。</p>
<p>​	<strong>设置</strong>中断向量的2种方法：</p>
<p>​	▲直接写入法</p>
<p>​	▲利用DOS功能调用</p>
<p><strong>① 直接写入法</strong></p>
<p>  直接使用<strong>MOV****指令</strong>把中断向量写入向量表对应的单元。</p>
<p><strong>方法：</strong></p>
<ul>
<li><p>设中断类型号为n，对应的中断服务程序名为P1，则：</p>
<p>   将P1程序的偏移地址（OFFSET P1）<strong>放到内存</strong>0数据段的[4n+1] 和 [4n]单元中；</p>
</li>
</ul>
<p>​	 将其<strong>段地址</strong>（SEG P1）放到 [4n+3] 和 [4n+2]单元中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CLI						 ；关中断</span><br><span class="line">MOV	AX，0</span><br><span class="line">MOV	DS，AX				；中断向量表段基址为0</span><br><span class="line">MOV	AX，OFFSET  P1		；中断类型号为n，P1程序</span><br><span class="line">MOV	BX，n*4</span><br><span class="line">MOV	DS:[BX]，AX 			；偏移地址放入4n,4n+1单元</span><br><span class="line">MOV AX，SEG  P1	</span><br><span class="line">MOV DS:[BX+2]，AX		；段地址写入4n+2,4n+3单元</span><br><span class="line">STI					 	 ；开中断</span><br></pre></td></tr></table></figure>

<p>【例5-2】某外设的中断服务程序名为IRQ3_ISR，中断类型号为5。请使用直接写入法设置其中断向量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CLI			     	 ；关中断</span><br><span class="line">MOV	AX，0</span><br><span class="line">MOV	DS，AX	     	 ；中断向量表段基址为0</span><br><span class="line">MOV	AX，OFFSET IRQ3_ISR </span><br><span class="line">MOV	DS:[0014H]，AX	 ；MOV WORD PTR[BX], AX</span><br><span class="line">MOV AX，SEG IRQ3_ISR 	</span><br><span class="line">MOV DS: [0016H]， AX 	</span><br><span class="line">STI			      	 ；开中断</span><br></pre></td></tr></table></figure>

<p><strong>②</strong> <strong>DOS</strong> <strong>功能调用写入法</strong></p>
<p>  使用INT 21H中断的25H号功能调用，设置中断向量。</p>
<p>   功能号：AH &#x3D; 25H</p>
<p>   入口参数：</p>
<p>​       DS &#x3D; 中断服务程序入口地址的<strong>段基址</strong></p>
<p>​       DX &#x3D; 中断服务程序入口地址的<strong>偏移量</strong></p>
<p>​       AL &#x3D; <strong>中断类型号</strong></p>
<p>【例5-3】某外设的中断服务程序名为P1，中断类型号为5。请使用DOS功能调用法设置其中断向量。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PUSH  DS		          ；原 DS 入栈</span><br><span class="line">MOV	AX，SEG  P1           ；段基址存入DS中</span><br><span class="line">MOV	DS，AX	</span><br><span class="line">MOV AX，OFFSET  P1	</span><br><span class="line">MOV DX，AX	          	；偏移地址存入DX中</span><br><span class="line">MOV AL，5		           ；中断类型号在AL中</span><br><span class="line">MOV AH，25H                  ；DOS调用功能号</span><br><span class="line">INT 21H</span><br><span class="line">POP DS		          	 ；DS出栈</span><br></pre></td></tr></table></figure>

<p><strong>中断向量的修改</strong></p>
<p>   中断类型号不变，但是其指向的中断服务程序（入口地址）改变，即中断向量改变。</p>
<p>   修改中断向量的步骤：</p>
<p>1.利用35H号功能，<strong>获取原中断向量</strong>，并保存。</p>
<p>2.利用25H号功能，<strong>设置新的中断向量</strong>。</p>
<p>3.新的中断服务程序服务完毕，利用25H号功能<strong>恢复原中断向量</strong>。</p>
<p>35H号功能——读取中断向量</p>
<p>   入口参数：AH &#x3D; 35H，AL &#x3D; 中断号</p>
<p>   出口参数：ES &#x3D; 中断服务程序入口地址的<strong>段基址</strong></p>
<p>　　　　　   BX &#x3D; 中断服务程序入口地址的<strong>偏移地址</strong></p>
<p>25H号功能——设置新的中断向量</p>
<p>   入口参数：AH &#x3D; 25H，AL &#x3D; 中断号</p>
<p>​            <strong>DS</strong> &#x3D; 中断服务程序入口地址的段基址</p>
<p>　　    <strong>DX</strong> &#x3D; 中断服务程序入口地址的偏移地址</p>
<p>   出口参数：无</p>
<p>【例5-4】修改类型号为n的中断向量，使得新中断服务程序入口地址的段基址为SEG_INTR，偏移地址为OFFSET_INTR。对应的程序段为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">MOV	AH，35H             ；获取原中断向量</span><br><span class="line">MOV	AL， n	</span><br><span class="line">INT 21H                      ；保存在 ES: BX中</span><br><span class="line">MOV OLD_OFF，BX   ；保存原中断向量的偏移量	</span><br><span class="line">MOV BX，ES</span><br><span class="line">MOV OLD_SEG，BX  ；保存原中断向量的段基址	</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">MOV	AH，25H                     ；设置新的中断向量</span><br><span class="line">MOV	AL， n</span><br><span class="line">MOV    DX，SEG_INTR	</span><br><span class="line">MOV    DS，DX		 		；DS = 段基址</span><br><span class="line">MOV    DX，OFFSET_INTR	 	；DX = 偏移地址</span><br><span class="line">INT      21H</span><br><span class="line">--------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line">MOV	AH，25H                     ；恢复原中断向量</span><br><span class="line">MOV	AL， n</span><br><span class="line">MOV    DX，OLD_SEG	</span><br><span class="line">MOV    DS，DX		 	；DS = 段基址</span><br><span class="line">MOV    DX，OLD_OFF	 	；DX = 偏移地址</span><br><span class="line">INT      21H</span><br></pre></td></tr></table></figure>

<h3 id="5-3-8259A可编程中断控制器"><a href="#5-3-8259A可编程中断控制器" class="headerlink" title="5.3 8259A可编程中断控制器"></a>5.3 8259A可编程中断控制器</h3><p>lIntel 8259A是一种可编程中断控制器，可协助CPU进行中断<strong>管理</strong>。其功能：</p>
<p>▲接收和扩充外设的中断请求</p>
<p>▲屏蔽或打开中断</p>
<p>▲中断优先级排队</p>
<p>▲提供中断类型号</p>
<p>▲接受CPU命令或返回当前工作状态</p>
<p>一片8259A可直接管理8级中断，通过级联可扩展至64级中断。</p>
<p>通过对8259A进行编程，可设置多种工作方式，以满足不同中断系统的需要。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221013232408194.png" alt="image-20221013232408194"></p>
<ul>
<li>数据总线缓冲器：</li>
</ul>
<p>​		▲8位的双向三态缓冲器，连接8259A与系统数据总线。</p>
<p>​		▲用于在CPU与8259A间传送数据、命令和状态信息。</p>
<ul>
<li>读&#x2F;写信号线</li>
</ul>
<p>​		▲接收CPU命令，完成对8259A内部端口的读写操作。</p>
<p>​		▲思考：A0为什么可以一个接口来分辨3个寄存器</p>
<ul>
<li>级联&#x2F;缓冲器</li>
</ul>
<p>​		▲CAS0 ~ CAS2 用于多块8259A的级联。</p>
<p>​		▲思考：如何区分主从片？</p>
<p>用SP输入来判断主从片，主片输入高电平，从片输入低电平</p>
<ul>
<li><u>中断屏蔽寄存器IMR （interrupt mask register）</u></li>
</ul>
<p>​		▲8位寄存器，第 i 位为1，表示屏蔽 IRi 的请求。</p>
<p>​		▲其值可通过<strong>软件设置或改变</strong>。</p>
<p>​		▲思考：IRR可软件改变吗？可以</p>
<ul>
<li><u>中断请求寄存器 IR7~IR0 IRR(interrupt request register)</u></li>
</ul>
<p>​		▲8位寄存器，通过引脚 IR0 ~ IR7 与8个中断源相连。</p>
<p>​		▲若IRi &#x3D; 1，表明对应的中断源有中断请求，则 IRR寄存器相应的第 i 位置1 。</p>
<p>​		▲<strong>思考</strong>：谁来置位？何时标志位清除？</p>
<ul>
<li><u>服务状态寄存器ISR(interrupt service register)</u></li>
</ul>
<p>​		▲8位，用来记录CPU当前正在为哪些中断源服务。</p>
<p>​		▲当CPU<strong>响应</strong>IRi <strong>请求时，ISR</strong>中相应的位置1。是否可能有多个1？为什么？</p>
<p>​		▲当某个<strong>中断已被</strong>处理，<strong>ISR</strong>相应的位复位<strong>。</strong>由谁来复位？</p>
<ul>
<li><u>优先权分辨器 PR （priority register）</u></li>
</ul>
<p>​		▲对已进入IRR且未被IMR屏蔽的中断请求判定优先级，确定优先级最高的中断，向CPU发送中断请求信号INT。</p>
<p>​		▲若8259A正在为某中断服务时，又出现了新的中断请求，则PR判断<strong>新的中断请求</strong>优先级是否更高。若是，则进入<strong>中断嵌套</strong>。</p>
<p>▲ICW：初始化命令字（Initialization Command Word）</p>
<p>▲OCW：操作命令字（Operation Command Word）</p>
<p>引脚介绍</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221013233229037.png" alt="image-20221013233229037"></p>
<p>D7~D0:双向三态数据线，在8259A与CPU间传送数据、命令和状态信息。</p>
<p>&#x2F;WR&#x2F;RD&#x2F;CS:写、读、片选信号。</p>
<p>A0:选择8259A内部寄存器。A0&#x3D;0选<strong>偶端口</strong>，A0&#x3D;1选<strong>奇端口</strong>。</p>
<p>INT:向CPU发的中断请求信号，高有效。</p>
<p>&#x2F;INTA:CPU返回的中断响应信号，为2个负脉冲。</p>
<p>IR7~IR0:中断请求信号，高电平或上升沿有效。</p>
<p>&#x2F;SP&#x2F;&#x2F;EN:主从片设定&#x2F;允许缓冲信号，双向双功能。</p>
<p>​		▲缓冲方式下：输出，<strong>EN****信号控制缓冲器</strong>。</p>
<p>​		▲非缓冲方式下：输入，表示8259A是<strong>主片</strong>（SP &#x3D; 1）还是<strong>从片</strong>（SP &#x3D; 0） 。</p>
<p>CAS0&#x2F;CAS1&#x2F;CAS2:级联信号线，双向。</p>
<p>​		▲主片的CAS2~0为输出。</p>
<p>​		▲从片的 CAS2~0为输入</p>
<p><strong>1. 8259A</strong> <strong>的工作过程</strong></p>
<p>  单片8259A工作时，每次中断处理过程如下：</p>
<p>①当 IR7 ~ IR0 上有中断请求，则 <strong>IRR</strong> 相应的位置1。</p>
<p>②对于已进入IRR且未被IMR屏蔽的中断请求，<strong>PR</strong>电路进行优先级判定，得到最高级的中断请求。</p>
<p>③控制逻辑接收中断请求，向CPU发 <strong>INT</strong> 信号。</p>
<p>④若CPU允许中断，则在当前指令结束后连续发出2个<strong>INTA</strong>，进行中断响应。每个INTA持续2个时钟周期。</p>
<p>⑤CPU发第一个 INTA 时，有效总线锁定信号 LOCK，防止其它处理器或DMA控制器占用总线。</p>
<p>   8259A收到第一个INTA后，将优先级<strong>最高的中断对应的</strong>ISR位置1，同时使IRR相应的位清0。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221014094817167.png" alt="image-20221014094817167"></p>
<p>⑥CPU发第二个 INTA 时，撤销 LOCK，使地址允许信号 ALE无效，允许数据线工作。</p>
<p>   8259A收到第二个负脉冲后，将相应<strong>中断的类型号</strong>送到数据线上。CPU读取中断类型号，<strong>查找中断向量表</strong>得到中断向量，转而进入中断服务程序。</p>
<p>⑦若系统为<strong>自动结束中断方式</strong> (AEOI)，则8259A在第2个脉冲结束时，<strong>自动</strong>将ISR的相应位复位；</p>
<p>   若为非自动结束中断方式 (EOI)，则ISR相应位的“1”一直保持，直到CPU发EOI (中断结束) 命令时才将其复位。</p>
<p><strong>2. 8259A</strong> <strong>的级联方式</strong></p>
<p>▲单片8259A最多可管理8级中断。当中断源多于8个时，需将多个8259A芯片级联构成<strong>主从模式</strong>。</p>
<p>▲系统最多支持8个8259A芯片级联，即：最多可支持64个中断源。</p>
<p>▲每个从片的IR7 ~ IR0可直接与8个中断源相连，经过优先级判优后<strong>主片</strong>发送INT信号。主片对所有从片发来的INT进行判优后，最终向CPU发INT信号。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221014095208738.png" alt="image-20221014095208738"></p>
<p>▲SP&#x2F;EN用于区分主从片。</p>
<p>  高为主片，低为从片。</p>
<p>▲主、从片通过CAS2<del>CAS0 互连。主片的CAS2</del>CAS0为输出，从片的CAS2~CAS0 为输入。</p>
<p>​	ØCPU发出<strong>第一个****INTA</strong>时，主片使ISR相应的位置1，使IRR的相应位清0；并通过CAS2<del>CAS0 输出一组<strong>从片的编码</strong> ID2</del>ID0。</p>
<p>​	Ø从片收到该编码后，与自身的编码（存放在ICW3的D2~D0 中）进行<strong>比较</strong>。若相同，则在<strong>第二个****INTA</strong>信号将从片的<strong>中断类型号</strong>送到数据总线。</p>
<p><strong>4.</strong> <strong>中断屏蔽方式</strong></p>
<p>①<strong>普通屏蔽方式：屏蔽同级和低级中断</strong></p>
<p>▲IMRi&#x3D;1，则禁止相应的中断请求；为0，则允许。</p>
<p>▲这种方式下，由于优先权判别器PR的作用（<strong>查<strong><strong>ISR</strong></strong>的状态</strong>），只有级别高的中断源才允许中断。</p>
<p>▲若CPU不希望某些中断源申请中断，或在处理某中断时不希望比该中断级别低的中断源申请中断，可采用该方法。</p>
<p>②<strong>特殊屏蔽方式</strong></p>
<p>▲在处理某中断时，若想开放<strong>级别较低的中断请求</strong>，则：(1) 将IMR中本级中断的相应位置1，<strong>屏蔽本级中断</strong>，为开放级别较低的中断提供可能。(2) 将<strong>本级中断</strong> <strong>ISR</strong> <strong>的相应位复位</strong>，才能真正开放级别较低的中断。</p>
<p>与普通屏蔽的<strong>区别</strong>：特殊屏蔽方式除了在<strong>IMR</strong>中屏蔽本级中断源外，还需使当前<strong>ISR</strong>的相应位复位。</p>
<p><strong>5.</strong> <strong>中断优先权管理方式</strong></p>
<p> <strong>① 固定优先级</strong>**–**IR0 优先级最高，IR7 最低。</p>
<p> <strong>② 循环优先级</strong>**–**某中断被服务后，其优先权自动降为最低，而相邻中断源的优先级升为最高。</p>
<p>n<strong>优先权<strong><strong>自动</strong></strong>循环方式</strong></p>
<p>​	Ø初始时，IR0 优先级最高，IR7 优先级最低。</p>
<p>n<strong>优先权<strong><strong>特殊</strong></strong>循环方式</strong></p>
<p>​	Ø用户编程来<strong>指定</strong>初始时哪个中断源的优先级最低。</p>
<p>​	Ø例：初始时规定 IR5 最低，则优先级顺序为：IR6 &gt; IR7 &gt; IR0 &gt; … &gt; IR4 &gt; IR5。</p>
<p><strong>6.</strong> <strong>中断嵌套方式</strong></p>
<p>①<strong>普通全嵌套方式</strong></p>
<p>​	Ø简称<strong>全嵌套方式</strong>，是最基本、最常用的方式。</p>
<p>​	Ø某中断被响应时，只有<strong>更高级</strong>的中断请求才会响应。</p>
<p>②<strong>特殊全嵌套方式</strong></p>
<p>​	Ø用于<strong>级联</strong>场合。可响应<strong>高级别</strong>和<strong>同级别</strong>中断。</p>
<p>​	Ø级联时从片的 INT端连接主片 IRi 端。从片上不同级别的中断请求，主片视之为同一级别。普通全嵌套无法响应第二次高级别中断。而特殊全嵌套方式可正常响应。</p>
<ul>
<li><p>单片8259A时，通常采用普通全嵌套方式。</p>
</li>
<li><p>多片级联时，从片采用普通全嵌套方式，而<strong>主片必须采用特殊全嵌套</strong>。</p>
</li>
</ul>
<p><strong>7.</strong> <strong>中断结束方式</strong></p>
<p>▲当某个中断请求得到响应时，其ISRi置1。当其中断服务结束时，其ISRi必须清0。</p>
<p>▲中断结束方式是<strong>指使</strong>ISR<strong>相应位复位的方式</strong>。</p>
<p>▲8259A有2种中断结束方式</p>
<p>①自动结束方式（AEOI）</p>
<p>​	ØISRi的复位由8259A硬件自动完成。</p>
<p>​	Ø当CPU响应某中断时，<strong>第二个INTA信号</strong>自动将ISRi复位。（第二个INTA信号的上升沿或者下降沿时，复位）</p>
<p>​	Ø该方式只适用于单片8259A、无中断嵌套的场合。</p>
<p>②非自动结束方式（EOI）</p>
<p>该方式下，由CPU<strong>发EOI命令</strong>来使ISR的相应位复位。</p>
<ul>
<li><strong>普通中断结束方式</strong></li>
</ul>
<p>​		ØCPU向8259A发送EOI命令，使当前 ISR 中<strong>级别最高</strong>的位复位。（仅级别最高复位）</p>
<ul>
<li><strong>特殊中断结束方式</strong></li>
</ul>
<p>​		ØCPU向8259A发送EOI命令，该命令字<strong>指定</strong>了要结束哪一级中断源，从而使ISR相应的位复位。（指定复位，最为准确）</p>
<p><strong>8.</strong> <strong>连接系统总线的方式</strong></p>
<p>①<strong>缓冲方式</strong></p>
<p>▲<strong>多片</strong>8259A级联时，8259A 通过<strong>总线驱动器</strong>与数据总线相连。</p>
<p>▲此时8259A的 SP&#x2F;<strong>EN</strong> 端输出一个低电平 ( EN &#x3D; 0) 作为<strong>总线驱动器的启动信号</strong>。即：SP&#x2F;EN 信号与总线驱动器的使能端相连。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018151056006.png" alt="image-20221018151056006"></p>
<p>从片与主片的区分在ICW4中描述</p>
<p>②<strong>非缓冲方式</strong></p>
<p>​	Ø当系统中只有<strong>单片或少数几片</strong> 8259A 时，8259A 可<strong>直接</strong>与数据总线相连。此时，8259A的<strong>SP</strong>&#x2F;EN端作为<strong>输入信号</strong>。</p>
<p>​	Ø单片8259A时，SP &#x3D; 1。多片8259A 级联时，主片的 SP &#x3D; 1，从片的 SP &#x3D; 0。</p>
<h4 id="8259A编程"><a href="#8259A编程" class="headerlink" title="8259A编程"></a>8259A编程</h4><p>CPU向8259A发送的命令字分为以下2种：</p>
<ul>
<li><strong>初始化命令字</strong> <strong>ICW</strong></li>
</ul>
<p>​		▲共有ICW1 ~ ICW4 4个，在<strong>系统初始化时</strong>设置。</p>
<p>​		▲一旦设定后，在系统工作过程中一般<strong>不再改变</strong>。</p>
<ul>
<li><strong>操作命令字</strong> <strong>OCW</strong></li>
</ul>
<p>​		▲共有OCW1~OCW3 3个，用来对中断处理过程进行<strong>动态控制</strong>，如：中断屏蔽、中断结束、优先权设定等。</p>
<p>​		▲可<strong>多次设置和改变</strong>。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018151542648.png" alt="image-20221018151542648"></p>
<p>8259A通过一根地址线A0就可以通过<strong>顺序法</strong>和<strong>特征位法</strong>判断7个寄存器，解决端口冲突。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ICW1： 20H	  D4 = 1</span><br><span class="line">ICW2： 21H	  </span><br><span class="line">ICW3： 21H	  </span><br><span class="line">ICW4： 21H	</span><br><span class="line"></span><br><span class="line">OCW1：21H </span><br><span class="line">OCW2：20H   D3D4 = 00</span><br><span class="line">OCW3：20H   D3D4 = 10</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ICW1、ICW2、ICW3、ICW4是通过顺序法来解决端口冲突的。</p>
<p>因为ICW是初始化后就不可以再修改，因此设定在写ICW1的时候默认接下来写的就是ICW2、ICW3、ICW4</p>
<p>作为主片 ICW1的端口为20H ICW2、ICW3、ICW4的端口为21H</p>
<p>作为从片 ICW1的端口为0A0H ICW2、ICW3、ICW4的端口为0A1H</p>
<p>OCW1的端口设定为21H  OCW2、OCW3与ICW1通过特征位来判断各自的端口、ICW1的D4端口为1 OCW2的特征位D3D4 &#x3D; 00	OCW3的特征位D3D4 &#x3D; 10</p>
<p><strong>（一）初始化命令字</strong> <strong>ICW</strong></p>
<p><strong>1. ICW1</strong>：设置触发方式、是否级联和需ICW4等。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018152538833.png" alt="image-20221018152538833"></p>
<p>ICW1默认初始化为11H（0001 0001）即 D3&#x3D;0，D2&#x3D;0，D&#x3D;0，D&#x3D;1</p>
<p><strong>2. ICW2</strong>：设置类型码，紧随ICW1 <strong>之后。</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018153205772.png" alt="image-20221018153205772"></p>
<ul>
<li><p>中断类型号 &#x3D; ICW2高5位 + 低3位 (IRi 的编码) 。</p>
</li>
<li><p>CPU发第2个INTA响应时，8259A 将ICW2的内容（中断类型号）送到数据总线。</p>
</li>
</ul>
<p>​	主片的默认端口地址为08<del>0FH 从片的默认地址为70</del>77H</p>
<p>​	主片高5位默认 00001 从片高5位默认为01110</p>
<p>​	主片与从片低3位为第i位的二进制</p>
<p><strong>3. ICW<strong><strong>3</strong></strong>：设置级联方式。</strong></p>
<ul>
<li><p>仅当级联模式下（即 ICW1 的 SNGL &#x3D; 0 时）才需设置ICW3。这时需分别对<strong>主片</strong>和<strong>从片</strong>进行设置。</p>
</li>
<li><p><strong>主片</strong>ICW3：说明主片IR7 ~ IR0 的哪些引脚上连有从片。</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018153905747.png" alt="image-20221018153905747"></p>
<ul>
<li><strong>从片</strong>ICW3： ID2~ID0编码值说明该从片的<strong>INT****信号</strong>连接至主片 IR7 ~ IR0 的哪个引脚。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018154332352.png" alt="image-20221018154332352"></p>
<p><strong>4. ICW4</strong>：设置缓冲方式、中断结束方式等。</p>
<p>当 ICW1 的 D0 &#x3D;1时，需设置ICW4。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221018154721722.png" alt="image-20221018154721722"></p>
<p>主片默认D4&#x3D;1 D3&#x3D;1</p>
<h3 id="5-4-8259A的应用举例"><a href="#5-4-8259A的应用举例" class="headerlink" title="5.4 8259A的应用举例"></a>5.4 8259A的应用举例</h3><h3 id="5-5-PC机中的中断应用"><a href="#5-5-PC机中的中断应用" class="headerlink" title="5.5 PC机中的中断应用"></a>5.5 PC机中的中断应用</h3><h2 id="第六章-并行接口"><a href="#第六章-并行接口" class="headerlink" title="第六章 并行接口"></a>第六章 并行接口</h2><h3 id="6-1-并行接口概念"><a href="#6-1-并行接口概念" class="headerlink" title="6.1 并行接口概念"></a>6.1 并行接口概念</h3><p>传送方式分为串行传送与并行传送，并行传送以字长为单位进行传送，一次传送多位 ，需要多根数据线；串行传送以一根数据线一位一位传送，速度慢。</p>
<p>并行传送方式又分为：基本的并行接口与可编程并行接口</p>
<h3 id="6-2-8255A可编程并行接口"><a href="#6-2-8255A可编程并行接口" class="headerlink" title="6.2 8255A可编程并行接口"></a>6.2 8255A可编程并行接口</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221107172458656.png" alt="image-20221107172458656"></p>
<p>8255A芯片分为3个端口，端口A输入&#x2F;输出都有锁存功能，而端口B与端口C只有输出有锁存功能，而输入没有。</p>
<p>C口较为特殊，既可以作为一个独立的8位端口，也可以将高4位作为端口A的拓展位，将低4位作为端口B的拓展位。不仅可以作为数据的输入输出端口，也可以通过控制字的方式，配合端口A与端口B的工作。通过指定位置位&#x2F;复位</p>
<p>8255A的左侧与CPU相连：</p>
<ul>
<li><p>lD7 ~ D0：双向数据线，用于CPU与8255A间传送数据、状态和控制信息。</p>
</li>
<li><p>A1A0：用于选择端口地址。</p>
</li>
</ul>
<p>​		A1A0 &#x3D; 00：选择端口A</p>
<p>​		A1A0 &#x3D; 01：选择端口B</p>
<p>​		A1A0 &#x3D; 10：选择端口C</p>
<p>​		A1A0 &#x3D; 11：选择控制端口</p>
<ul>
<li><p>CS、RD、WR：片选、读、写信号，均为低有效。</p>
</li>
<li><p>lRESET：复位信号，高有效。RESET&#x3D;1时：</p>
</li>
</ul>
<p>​		▲清除所有内部寄存器的内容。</p>
<p>​		▲将A、B、C三个端口均设置为<strong>方式****0</strong>，<strong>输入</strong>。三个端口对外的信号线均为高阻态。</p>
<p>右侧与外设向连：</p>
<ul>
<li>PA7 ~ PA0、PB7 ~ PB0、 PB7 ~ PB0：三态双向数据线，直接与外设相连，输入输出由工作方式决定。</li>
</ul>
<p>​																							端口地址分配</p>
<table>
<thead>
<tr>
<th>CS</th>
<th>RD</th>
<th>WR</th>
<th>A1</th>
<th>A0</th>
<th>端口操作</th>
<th>地址</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>数据总线 → 端口A</td>
<td>60H</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>数据总线 → 端口B</td>
<td>61H</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>数据总线 → 端口C</td>
<td>62H</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>数据总线 → 控制寄存器</td>
<td>63H</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>端口A → 数据总线</td>
<td>60H</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>端口B → 数据总线</td>
<td>61H</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>端口C → 数据总线</td>
<td>62H</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>非法状态</td>
<td></td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>1</td>
<td>×</td>
<td>×</td>
<td>数据总线为高阻态</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>×</td>
<td>×</td>
<td>×</td>
<td>×</td>
<td>数据总线为高阻态</td>
<td></td>
</tr>
</tbody></table>
<p>6.2.2 8255A的编程</p>
<ul>
<li>8255A有2个控制字：<strong>方式选择控制字</strong>和<strong>C**<strong>口置位</strong></strong>&#x2F;*<em><strong>复位控制字</strong>，它们均写入</em>*同一个**控制端口。用特征位D7区分：</li>
</ul>
<p>​				▲方式字 (<strong>D**<strong>7</strong></strong>&#x3D;1**)：用于设置各端口的工作方式。</p>
<p>​				▲C口置位&#x2F;复位 (<strong>D**<strong>7</strong></strong>&#x3D;0**)：对C口的任意一位进行置位或复位，而不影响其它位的状态。</p>
<p>对ABC口的方式字控制初始化</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221107174214344.png" alt="image-20221107174214344" style="zoom:50%;" />

<p>对C口置位&#x2F;复位控制字设置</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221107174309599.png" alt="image-20221107174309599" style="zoom:50%;" />

<p>TIP:设置控制字的端口永远为控制口，无论是对ABC口设置还是对C口的置位&#x2F;复位操作</p>
<p>有两种对C口进行修改的操作：</p>
<p>①.l<strong>C</strong>口置位&#x2F;复位控制字法<strong>：对</strong>控制口(A1A0&#x3D;11)操作。特点：仅改变PCi 端的输出状态，PC口其它位不受影响</p>
<p>②.l<strong>向端口C写数据法</strong>：对<strong>C数据口</strong>(A1A0&#x3D;10)操作。将影响C口所有位的状态。</p>
<h3 id="6-3-8255A的工作方式"><a href="#6-3-8255A的工作方式" class="headerlink" title="6.3 8255A的工作方式"></a>6.3 8255A的工作方式</h3><p><strong>方式0——<em>基本输入</em></strong>&#x2F;输出</p>
<ul>
<li><p>A口、B口、C口的高4位和低4位均可<strong>独立</strong>地被设置为输入或输出。</p>
</li>
<li><p>8255A与CPU（8255A与外设之间？？？）之间<strong>没有<strong><strong>固定的</strong></strong>应答联络信号</strong>，可用于<strong>无条件传送</strong>或<strong>查询方式</strong>传送。</p>
</li>
<li><p>单向I&#x2F;O：一次初始化只能指定端口作为输入或作为输出，<strong>不能</strong>指定其同时<strong>既作为输入又作为输出</strong>。</p>
</li>
</ul>
<p><strong>方式</strong>1——选通输入&#x2F;输出（应答型）</p>
<ul>
<li><p>A、B口为数据口，C口的一些引脚作为A、B口的<strong>联络控制信号</strong>，有<strong>固定的搭配</strong>和<strong>时序关系</strong>。</p>
</li>
<li><p>可采用<strong>中断方式</strong>或程序<strong>查询方式</strong>传送数据。</p>
</li>
<li><p>单向I&#x2F;O：一次初始化只能设定在一个方向上传送。</p>
</li>
</ul>
<p>​	①方式1输入</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221107175748892.png" alt="image-20221107175748892" style="zoom:50%;" />

<ul>
<li><p>STB：输入选通信号。有效时，可将数据从外设输入到A口或B口的锁存器中。</p>
</li>
<li><p>IBF：输入缓冲器满信号，是对STB的响应。有效时，<strong>①</strong> <strong>对****CPU</strong>：<strong>表示<strong><strong>8255</strong></strong>端口有数据</strong>，通知CPU进行读取。<strong>②</strong> <strong>对外设</strong>：<strong>表示<strong><strong>CPU</strong></strong>还未取走数据</strong>，阻止外设发新数据。</p>
</li>
<li><p>INTE：中断允许信号。INTE&#x3D;1时允许8255向CPU发中断请求。<strong>PC****4</strong> <strong>&#x3D;1</strong>允许A口中断；<strong>PC****2</strong> <strong>&#x3D;1</strong>允许B口中断。该信号通过C口置位&#x2F;复位来实现。</p>
</li>
<li><p>INTR：中断请求信号。INTR&#x3D;1时，CPU可从端口读取数据。读取后INTR自动清除。</p>
</li>
</ul>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\Desktop\QQ图片20221107181308.jpg" alt="QQ图片20221107181308" style="zoom: 25%;" />

<p>对于端口A来说，外设发送信息给8255A，将信息写入INBFF中，若INBUFF满了，则发送IBF（input buffer full）至PC5，同时，PC5端连接外设，当外设收到IBF信号时，就了解了INBFF已经满了，停止再发送信息；同时，IBF也被传送到了CPU中，对于CPU来说，意味着INBFF满了，要及时去接收信息。</p>
<p>同时，&#x2F;STB信号将激活中断使能，当中断使能为低电平，IBF为高电平时，即生成中断信号交付给CPU，让CPU通过中断的方式接收8255A中INBFF的信号</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221107182705301.png" alt="image-20221107182705301" style="zoom:50%;" />

<p>【例6-9】按下开关时，从A口输入开关状态在B口上显示，重复100次。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">主程序设计：</span><br><span class="line">Start:	CLI			; 关中断</span><br><span class="line">	MOV   AL, 10110000B 	; 设置8255A的工作方式控制字</span><br><span class="line">	OUT   63H,  AL</span><br><span class="line">	MOV   AL,  00001001B 	; PC4置1, 允许A端口中断  	</span><br><span class="line">             OUT   63H,  AL</span><br><span class="line">	MOV   AL, 00011011B	; 设置ICW1: 单片, 电平触发, ICW4</span><br><span class="line">	OUT   20H, AL</span><br><span class="line">	MOV   AL, 08H		; 设置ICW2: 中断类型号</span><br><span class="line">	OUT   21H, AL 	</span><br><span class="line">         	MOV   AL, 00000001B	; 设置ICW4: EOI, 普通全嵌套</span><br><span class="line">	OUT   21H, AL		</span><br><span class="line">	    	MOV	AX，0	      	               ；中断向量表段地址</span><br><span class="line">    	MOV	DS，AX</span><br><span class="line">    	MOV	AX，OFFSET  IS8255     ；设置中断向量</span><br><span class="line">  	MOV     [0020H]，AX</span><br><span class="line">   	MOV	AX，SEG  IS8255</span><br><span class="line">    	MOV	[0022H]，AX</span><br><span class="line">   	IN         AL，21H	      	   ；读8259A屏蔽字</span><br><span class="line">    	AND     AL，0FEH	      	   ；允许IR0中断</span><br><span class="line">   	OUT     21H，AL</span><br><span class="line">   	MOV    BX，100	     	   ；设置计数初值</span><br><span class="line">    	STI </span><br><span class="line">ROTT：CMP	BX，0		；监测是否达到100次</span><br><span class="line">         	 JNZ	ROTT		；未达到，则等待中断</span><br><span class="line">	  IN   	AL，21H	；恢复屏蔽字，禁止IR0中断</span><br><span class="line">         	  OR  	AL，01H</span><br><span class="line">         	  OUT	21H，AL</span><br><span class="line">         	  MOV 	AH，4CH	；返回DOS系统</span><br><span class="line">         	  INT	21H</span><br><span class="line">中断服务程序：</span><br><span class="line">IS8255：IN    	AL，60H	；读取端口A的开关量</span><br><span class="line">        	  OUT  	61H，AL	；输出给端口B显示</span><br><span class="line">       	  DEC  	BX 		；计数值减1</span><br><span class="line">       	  MOV  	AL，20H	；发中断结束命令</span><br><span class="line">       	  OUT  	20H，AL </span><br><span class="line">        	  IRET			；中断返回</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>②<strong>方式1</strong>输出</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221107182809977.png" alt="image-20221107182809977" style="zoom:50%;" />

<ul>
<li><p>OBF：输出缓冲器满。有效时，表CPU已把数据输出到8255。<strong>①</strong> <strong>对外设</strong>：<strong>通知外设取走数据</strong>。<strong>②</strong> <strong>对****CPU</strong>：阻止CPU发新数据。</p>
</li>
<li><p>ACK：外设的应答信号。外设<strong>取走数据后</strong>，向8255发应答信号，并使OBF无效，此时CPU可发新数据。</p>
</li>
<li><p>INTE：中断允许信号。为1时允许8255向CPU发中断请求。<strong>PC****6</strong> <strong>&#x3D;1</strong>允许A口中断；<strong>PC****2</strong> <strong>&#x3D;1</strong>允许B口中断。该信号通过C口置位&#x2F;复位来实现。</p>
</li>
<li><p>INTR：中断请求信号。为1时请求CPU向8255发数据。</p>
</li>
</ul>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\Desktop\1667817784035.jpg" alt="1667817784035" style="zoom: 25%;" />

<p>CPU对外设输出时，将date写到OutBff，当OutBff满时，发送&#x2F;OBF信号。对于外设来说，&#x2F;OBF信号告知外设尽快取数据；对于CPU外设来说，&#x2F;OBF信号告知CPU停止向外输出数据。外设接收OutBFF中的数据后，发送&#x2F;ACK告知8255A OutBff中的数据已被取完。CPU时时监控&#x2F;ACK信号，收到&#x2F;ACK信号时，CPU开始向8255A中的OutBff写数据。</p>
<p>ACK信号又是INTE的使能信号，意味着8255A收到ACK信号的同时，就有中断信号发送往CPU产生中断。</p>
<h2 id="第七章-串行通信接口"><a href="#第七章-串行通信接口" class="headerlink" title="第七章 串行通信接口"></a>第七章 串行通信接口</h2><h3 id="7-1-串口通信基本概念"><a href="#7-1-串口通信基本概念" class="headerlink" title="7.1 串口通信基本概念"></a>7.1 串口通信基本概念</h3><ul>
<li><p>并行传送方式<br>▲ 以字长为单位进行传送，用多根线一次传送多位数据。<br>▲ 特点：传送速度快。但使用信号线多， 成本高；且信号线间电容会引起 串扰，不适合远距离传送。<br>▲ 一般用于外设与微机间 近距离、大量和快速的传输。</p>
</li>
<li><p>串行传送方式<br>▲ 通过 一根线一位一位顺序传输数据。<br>▲ 缺点：速度慢。但传输线少，成本低。<br>▲ 适合于 远距离、低速率的数据传输。</p>
</li>
</ul>
<p>串行通信的数据传送方式分为以下三种:单工方式、半双工方式、全双工方式。</p>
<ul>
<li><p>单工方式<br>只允许在一个方向上传送数据。</p>
</li>
<li><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115232716315.png" alt="image-20221115232716315" style="zoom:50%;" />
</li>
<li><p>半双工方式<br>双方均具备发送、接收能力，但同一时刻只能进行一个方向的传送。</p>
</li>
</ul>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115232727220.png" alt="image-20221115232727220" style="zoom:50%;" />

<ul>
<li>全双工方式<br>收发双方可同时进行双向的数据传送。</li>
</ul>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115232736414.png" alt="image-20221115232736414" style="zoom: 50%;" />

<p>通信速率的单位有两种①.比特率,②.波特率</p>
<ul>
<li>比特率：每秒传送的 二进制位数，单位：bit&#x2F;s。</li>
<li>波特率：每秒传送的 Ｎ进制位数，单位：bout&#x2F;s。</li>
<li>两者的关系： 比特率＝波特率× ×log 2 N。</li>
</ul>
<p>收&#x2F; 发时钟TxClk&#x2F;RxCLK 与波特率因子factor的关系</p>
<ul>
<li>串行通信时，收发双方用CLK来 同步。收&#x2F;发时钟决定了通信线路上的数据传输速率。</li>
<li>发送端在TxClk↓ ↓使数据送入 移位寄存器串行输出。接收端在RxClk↑ ↑将传输线上的数据逐位打入移位寄存器。</li>
<li>为提高抗干扰能力，可用多个时钟来调制一位二进制数。调制一位二进制数的时钟个数称为波特因子（Factor）。</li>
<li>收&#x2F;发时钟频率与波特率的关系：TxClk&#x2F;RxClk &#x3D; Factor×Baud.</li>
<li>Factor一般取1, 16, 32 或 64。异步通信时常取16；同步通信则必须1。</li>
</ul>
<p>信息的调制与解调</p>
<ul>
<li>原因：数字信号包含很多直流和低频成分，直接传输时会严重 衰减，从而在接收端产生 严重畸变和 失真。</li>
<li>解决办法：发送方使用 调制器 (Modulator)，把要传送的数字信号转换为适合在线路上传输的模拟信号。接收方则使用 解调器(Demodulator)将模拟信号还原为数字信号。</li>
<li>双工和半双工通信设备，既要发送数据又要接收数据，故可将调制器和解调器做在一起，形成 调制解调器(Modem)。</li>
</ul>
<p>一般来说使用频移键控(FSK)来作为调制解调器。</p>
<p>工作原理：Ø 当信号为 1 时，开关1 闭合，开关 2 断开，经放大器输出频率1的信号；<br>                   Ø 当信号为 0 时，开关 1 断开，开关 2 闭合，经放大器输出频率 2 的信号。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115233253880.png" alt="image-20221115233253880"  />

<p>电子开关控制方法——继电器</p>
<p>用途：能够以 较小电流控制大电流的导通和切断，相当于一种“自动开关”，在电路中起自动调节、安全保护、转换电路等作用。分类：普通、干簧管式继电器</p>
<p>​	<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115233517025.png" alt="image-20221115233517025"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115233526780.png" alt="image-20221115233526780"  /><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115233558526.png" alt="image-20221115233558526"></p>
<p>​							普通继电器																			干簧继电器														触点种类</p>
<h3 id="7-2-串口通信协议"><a href="#7-2-串口通信协议" class="headerlink" title="7.2 串口通信协议"></a>7.2 串口通信协议</h3><ul>
<li>通信协议：为使通信能顺利进行，数据收发双方必须共同遵守的 通信规程，称为通信协议。</li>
<li>通信协议的基本内容：<br>▲ 波特率：双方约定的数据收&#x2F;发速率。<br>▲ 数据格式：双方约定的帧格式及控制信息的定义等。<br>▲ 帧同步：接收方获知一批数据开始和结束的方法。<br>▲ 位同步：接收方从数据流中正确采样到每位数据的方法。<br>▲ 差错校验方式：接收方判断收到数据正确性的方法。</li>
<li>串行通信协议的分类：<br>▲ 异步串行通信协议<br>▲ 同步串行通信协议</li>
</ul>
<p>7.2.1  异步串行通信协议</p>
<ul>
<li>特点 特点 字符间异步，字符内各位之间同步<br>▲ 以字符为单位进行信息传送。<br>▲ 字符与字符之间没有严格的定时要求，其间隙任意。<br>▲ 一旦开始传输一个字符，收发双方必须按照约定的速率，在时钟的作用下，一位一位地进行同步传输。</li>
<li>帧格式<br>  ▲ 数据格式包括： 同步信息（数据的开始与结束）、 数据信息和 校验信息。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115233927419.png" alt="image-20221115233927419"></p>
<p>▲ 采用 极性相反的起始位和停止位提供准确的时间基准。<br>▲ 一次传送1个字符 个字符。<br>▲ 具有信息校验， 可靠性高。<br>▲ 传输速率较慢， 效率低（max &#x3D; ?）。 一般用于数据量较小、传输率较低的场合。</p>
<p>奇偶校验位指的是数据位+奇偶校验位中高电位的个数，若为奇数则为1，若为偶数则为0</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234047977.png" alt="image-20221115234047977"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234100360.png" alt="image-20221115234100360"></p>
<p>7.2.2 同步串行通信协议</p>
<ul>
<li>特点 字符与字符间同步，字符内各位之间也同步<br>▲ 不使用起始位和停止位来标识字符的开始和结束，而是用一串特定的 二进制序列（ 同步字符），来通知接收方串行数据的第一位何时到达。<br>▲ 传输效率高，速度快，但其技术复杂， 硬件开销大。一般用于高速数据传输场合。</li>
<li>分类<br>▲ 面向字符的同步通信：一帧数据由若干个字符组成。<br>▲ 面向比特的同步通信：一帧数据由任意位 bit 组成，主要用于二进制的传输。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234154788.png" alt="image-20221115234154788"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234203614.png" alt="image-20221115234203614"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234217705.png" alt="image-20221115234217705"></p>
<p>典型的 面向字符的同步通信协议 的同步通信协议——IBM BSC<br>▲ BSC：Binary Synchronous Communication。<br>▲ 一帧由 若干字符组成，比异步起止式传输效率高。<br>▲ 规定了10个通信控制字符 个通信控制字符，作为数据块的开始和结束标志以及整个传输过程的控制信息，增强了通信控制能力和校验功能。<br>▲ 帧格式</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234240073.png" alt="image-20221115234240073"></p>
<p>② 面向 面向 比特 比特 的同步通信</p>
<ul>
<li>一帧数据可由任意位组成。</li>
<li>靠约定的 位组合模式来标志</li>
</ul>
<p> SDLC&#x2F;HDLC协议的帧格式</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234345246.png" alt="image-20221115234345246"></p>
<p>▲ 标志域：开始和结束标志，提供每帧信息的边界。<br>▲ 地址域 (A: Address)：通信的目标地址。<br>▲ 控制域 (C: Control)：规定了若干命令。<br>▲ 信息域 (I: Information)：包含要传送的数据。数据域为0时表示该帧为控制命令。<br>▲ 帧校验域 帧校验域 (FC: Frame Check)：采用16位CRC校验。</p>
<p>SDLC&#x2F;HDLC 实际应用时的2个技术问题：</p>
<p>▲ “ “0” ”位插入 位插入&#x2F;删除技术 删除技术：信息域中可能存在和标志字节01111110相同的字符，为了区别，发送端在发送除标志字节外的信息时，当遇到连续5个“1”时，就自动插入一个“0”。接收端若连续接收到5个“1”时，就自动删除其后的一个“0”，恢复信息。<br>▲ SDLC&#x2F;HDLC异常结束 异常结束：发送过程若出现错误，用异常结束字符使本帧作废。在HDLC规程中，失效字符为7个连续的“ “1 ”，在SDLC中为8个连续的 个连续的“ “1” ”。异常结束字符中不使用“0”位插入&#x2F;删除技术。</p>
<h3 id="7-3-串口通信接口标准"><a href="#7-3-串口通信接口标准" class="headerlink" title="7.3 串口通信接口标准"></a>7.3 串口通信接口标准</h3><ul>
<li>数据终端设备DTE(Data Terminal Equipment)：通常指计算机或I&#x2F;O设备。代表 数据源和 目的地。</li>
</ul>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234500938.png" alt="image-20221115234500938" style="zoom:50%;" />

<ul>
<li>数据通信设备DCE(Data Communication Equipment)：又称数据装置(Data Set)，通常为Modem。 作用： 使数据符合线路要求</li>
</ul>
<p>RS-232C标准规定了22 根控制信号线，实际常常只用到3~9根，多采用9 针或25 针的D型头来连接。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221115234529790.png" alt="image-20221115234529790"></p>
<h2 id="第八章-D-x2F-A与A-x2F-D转换器"><a href="#第八章-D-x2F-A与A-x2F-D转换器" class="headerlink" title="第八章 D&#x2F;A与A&#x2F;D转换器"></a>第八章 D&#x2F;A与A&#x2F;D转换器</h2><p>概念：</p>
<p>A&#x2F;D：模拟量→数字量 (Analog → Digital)。</p>
<p>​		实现A&#x2F;D转换的电路称为A&#x2F;D 转换器，简称ADC。</p>
<p>D&#x2F;A：数字量→模拟量 (Digital → Analog)。<br>        实现D&#x2F;A转换的电路称为D&#x2F;A 转换器，简称DAC。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128180837725.png" alt="image-20221128180837725"></p>
<h3 id="8-1-D-x2F-A转换"><a href="#8-1-D-x2F-A转换" class="headerlink" title="8.1 D&#x2F;A转换"></a>8.1 D&#x2F;A转换</h3><h4 id="8-1-1-D-x2F-A转换工作原理"><a href="#8-1-1-D-x2F-A转换工作原理" class="headerlink" title="8.1.1 D&#x2F;A转换工作原理"></a>8.1.1 D&#x2F;A转换工作原理</h4><p>​																							R-2R T 型电阻网络D&#x2F;A转换电路</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181253415.png" alt="image-20221128181253415"></p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181300127.png" alt="image-20221128181300127" style="zoom:50%;" />

<p>从左侧的接地开启看起，每个分支都是1&#x2F;(1&#x2F;2R+1&#x2F;2R)&#x3D;R 且左侧电阻与上侧电阻相同&#x3D;2R 所以电流相同 </p>
<p>∴共有n条分支，各分支的电流大小为：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181445486.png" alt="image-20221128181445486"></p>
<p>输入的数字量 输入的数字量 D i 控制模拟开关 控制模拟开关 S i </p>
<p>当Di&#x3D;0时，开关 S i 接地，支电流 I i 流向地；当D i &#x3D; 1时，开关 S i 接运放，支电流 I i 流向运放。</p>
<p>输出电流的大小为各支路流入的电流之和</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181556766.png" alt="image-20221128181556766"></p>
<p>D&#x2F;A的原理：</p>
<p>▲ 输出电压 V 0 &#x3D; -I×R f &#x3D; -D× ×R f， 故模拟电压输出V 0 与数字量输入D之间成正比关系。<br>▲ 常将 - 设为△，它表示最低位数字量变化时对应的模拟输出增量（ 分辨力）。<br>▲ 通过调整 R f 和V REF ，可调整D&#x2F;A的输出范围和满刻度。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181652185.png" alt="image-20221128181652185"></p>
<p>D&#x2F;A转换器的技术参数</p>
<p>（1）分辨率</p>
<p>▲ 表示最低位数字量变化时对应的模拟输出增量。它代表 分辨力。<br>▲ 分辨率：常用相对百分值表示，指△与最大满量程输出电压的比值。即：<br>                <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181759303.png" alt="image-20221128181759303" style="zoom: 50%;" /><br>▲ 分辨率只与数字量位数 数字量位数n有关，n越大，分辨率越高。分辨率越高，转换时对输入量的 微小变化反应越灵敏。<br>▲ 分辨率常用数字量位数表示，有8位、12位等。</p>
<p>（2）转换精度</p>
<p>▲ 指 实际输出值与 理论计算值之差。用于衡量D&#x2F;A转换的精确程度。<br>▲ 转换精度取决于D&#x2F;A转换器 各部件制作的 误差。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128181830589.png" alt="image-20221128181830589"></p>
<p>（3）建立时间</p>
<p>▲ 指从数字信号输入转换器开始，到输出端达到稳定值所需的时间。它决定了 转换速度。<br>▲ 目前10~12位单片集成D&#x2F;A转换器的建立时间多在1μs之内 之内。按其建立时间可分为：</p>
<p>​							低速：&gt;100 μs 	中速：1~100 μs	 高速：50ns ~ 1μs 	超高速：&lt; 50ns</p>
<p>（4）温度灵敏度<br>▲ 指数字输入量值不变的情况下，模拟输出信号 随温度的变化的情况。它表明D&#x2F;A转换器 受温度变化影响的特性。<br>▲ 一般D&#x2F;A转换器的温度灵敏度为±50ppm&#x2F;C。ppm为百万分之一。</p>
<h4 id="8-1-2-D-x2F-A转换器接口电路"><a href="#8-1-2-D-x2F-A转换器接口电路" class="headerlink" title="8.1.2 D&#x2F;A转换器接口电路"></a>8.1.2 D&#x2F;A转换器接口电路</h4><p>（1）D&#x2F;A转换器的分类</p>
<p>​	▲ 按 分辨率分：8位、10位、12位、14位、16位、18位、20位等。<br>​	▲ 按 建立时间分：低速、中速、高速和超高速型(&gt;100μs 、1<del>100μs、50ns</del>1μs、&lt;50 ns)。<br>​	▲ <strong>按 <u>内部是否有数据输入寄存器</u>分：带数据输入寄存器、不带数据输入寄存器。</strong><br>​	▲ <strong>按与<u>微机系统的连接关系分</u>：位数 <u>小于或等于</u>微机系统数据总线、位数 <u>大于</u>微机系统数据总线。</strong></p>
<p>（2）D&#x2F;A 转换器与CPU的数据缓冲 的数据缓冲</p>
<p>▲ DAC与CPU相连时，可看做一个外设，需连地址、数据和控制总线。<br>▲ 数据锁存问题：CPU向DAC输出数据时，数据在总线上停留的时间很短，而DAC要求在转换期间数据输入保持稳定。因此，需要 数据锁存器来 保持CPU输出给	 DAC的数据，直至转换结束。<br>▲ 对于内部自带数据锁存器的DAC ，CPU可直接与其相连；对于无数据锁存器的DAC ，须在DAC 外部另加数据锁存器。</p>
<h4 id="8-1-3-D-x2F-AC0832及其应用"><a href="#8-1-3-D-x2F-AC0832及其应用" class="headerlink" title="8.1.3 D&#x2F;AC0832及其应用"></a>8.1.3 D&#x2F;AC0832及其应用</h4><p>内部结构：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128183150245.png" alt="image-20221128183150245"></p>
<p>外部引脚：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128183224554.png" alt="image-20221128183224554"></p>
<ul>
<li>DI 0 ~ DI 7 ：8位数字输入端。</li>
<li>&#x2F;ILE： 输入锁存允许信号，高有效。</li>
<li>&#x2F;WR 1 ：写信号1， 输入寄存器 写选通信号。<ul>
<li>输入寄存器的锁存信号 LE 1 &#x3D; CS &amp; WR 1 &amp; ILE。</li>
<li>当三者同时有效时，LE 1 也有效，输入寄存器的输出随输入变化。 ↓锁存</li>
</ul>
</li>
<li>&#x2F;XFER： 数据传送控制信号，低有效。</li>
<li>&#x2F;WR 2 ：写信号2，DAC寄存器 写选通信号。<ul>
<li>DAC寄存器的锁存信号 &#x2F;LE 2 &#x3D; &#x2F;XFER &amp; &#x2F;WR 2 。</li>
<li>当两者同时有效时，LE 2 也有效，DAC寄存器的输出随其输入而变化。 ↓锁存</li>
</ul>
</li>
<li>I OUT1 ：电流输出端1。DAC寄存器的值为全1时，I OUT1最大；全0时，I OUT1 最小。</li>
<li>I OUT2 ：电流输出端2。I OUT1 + I OUT2 &#x3D; 满量程电流。</li>
<li>R FB ：反馈电阻。制作在芯片内部，供运放使用。</li>
<li>V REF ：基准电源输入端。一般在-10~10V范围内。</li>
<li>Vcc：逻辑电源输入端，范围为+5 ~ +15V。</li>
<li>AGND：模拟地，芯片模拟电路接地点。</li>
<li>DGND：数字地，芯片数字电路接地点。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128183454012.png" alt="image-20221128183454012"></p>
<p>DAC0832的工作方式</p>
<ul>
<li><p>直通工作方式——2个寄存器均直通放行</p>
<ul>
<li>CS、WR 1 、WR 2 、XFER接地，ILE接电源，故LE 1 和 LE 2 恒有效，两级寄存器均处于直通放行状态， 数据直接送入D&#x2F;A转换器进行D&#x2F;A转换。</li>
<li>这种方式不使用缓冲寄存器， 不能直接与CPU总线相连，可外接8255等接口芯片作为缓冲。</li>
</ul>
</li>
<li><p>单缓冲方式——1 个直通，1个受控</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128183654799.png" alt="image-20221128183654799"></p>
<ul>
<li>WR 2 和 XFER接地，使DAC 寄存器直通；ILE接高电平，WR 1 接CPU的IOW，CS接地址译码输出，输入寄存器处于受控状态。</li>
<li>输入数据只需一级缓冲即可送入D&#x2F;A转换电路，故 仅需执行一次写操作，即可完成D&#x2F;A转换。</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MOV AL，Data ；取数字量</span><br><span class="line">OUT PORT，AL ；启动D/A转换</span><br></pre></td></tr></table></figure>

<ul>
<li><p>双缓冲方式——2个寄存器均受控</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128183611476.png" alt="image-20221128183611476"></p>
<ul>
<li>双缓冲方式下， 需执行两条指令才能实现D&#x2F;A转换。设2个寄存器的端口地址分别为port1和port2，则：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MOV DX，port1</span><br><span class="line">OUT DX，AL ；打开输入寄存器</span><br><span class="line">MOV DX，port2 ；打开DAC寄存器</span><br><span class="line">OUT DX，AL ；AL内容可任意</span><br></pre></td></tr></table></figure>

<ul>
<li>该方式可用于 同时需要输出多个模拟量的场合。</li>
</ul>
</li>
</ul>
<p>利用D&#x2F;A转换器实现波形</p>
<p>方波程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">		MOV DX，203H ；8255A控制口地址</span><br><span class="line">		MOV AL，80H ；8255A控制字</span><br><span class="line">		OUT DX，AL ；8255A的A口方式0输出</span><br><span class="line">		MOV DX，200H ；8255A的A口地址</span><br><span class="line">AGAIN： MOV AL，00H</span><br><span class="line">		OUT DX，AL ；输出方波“0”</span><br><span class="line">		CALL DELAY ；方波“0”宽度</span><br><span class="line">		MOV AL，0FFH</span><br><span class="line">		OUT DX，AL ；输出方波“1”</span><br><span class="line">		CALL DELAY ；方波“1”宽度</span><br><span class="line">		JMP AGAIN</span><br></pre></td></tr></table></figure>

<p>锯齿波程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">		MOV DX，203H ；8255A控制口地址</span><br><span class="line">		MOV AL，80H ；8255A控制字</span><br><span class="line">		OUT DX，AL ；设置8255A 的A 口为方式0输出 输出</span><br><span class="line">		MOV DX，200H ；8255A的A口地址</span><br><span class="line">		MOV AL ，00H ；输出数据初值 ；输出数据初值</span><br><span class="line">J： 	   OUT DX，AL ；锯齿波输出</span><br><span class="line">		INC AL</span><br><span class="line">		JMP J</span><br></pre></td></tr></table></figure>

<p>三角波程序：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">		MOV DX，203H ；8255A控制口地址, 控制字</span><br><span class="line">		MOV AL，80H</span><br><span class="line">		OUT DX，AL ；设置8255A 的A口为方式0输出</span><br><span class="line">S：		MOV DX，200H ；8255A的A口地址</span><br><span class="line">		MOV AL，00H ； 正向锯齿波</span><br><span class="line">Z：		OUT DX，AL</span><br><span class="line">		INC AL</span><br><span class="line">		JNZ Z</span><br><span class="line">		MOV AL，0FFH ； 负向锯齿波</span><br><span class="line">F：		OUT DX，AL</span><br><span class="line">		DEC AL</span><br><span class="line">		JNZ F</span><br><span class="line">		JMP S</span><br></pre></td></tr></table></figure>

<h3 id="8-2-A-x2F-D转换"><a href="#8-2-A-x2F-D转换" class="headerlink" title="8.2 A&#x2F;D转换"></a>8.2 A&#x2F;D转换</h3><h4 id="8-2-1-A-x2F-D转换工作原理"><a href="#8-2-1-A-x2F-D转换工作原理" class="headerlink" title="8.2.1 A&#x2F;D转换工作原理"></a>8.2.1 A&#x2F;D转换工作原理</h4><ul>
<li>逐次逼近型A&#x2F;D转换器</li>
</ul>
<p>原理：从最高位开始通过 逐次试探进行测试，直到试探值经D&#x2F;A转换后的输出 V o 与 与V i 相等或达到允许的误差范围。该试探值就是A&#x2F;D转换对应的数字量。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128185048424.png" alt="image-20221128185048424"></p>
<p>转换过程：</p>
<p>▲ 在启动脉冲 时，逐次逼近寄存器清0。<br>▲ 第1个 CLK：逐次逼近寄存器 &#x3D; 1000 0000，被D&#x2F;A转换后得到V o 。<br>        若V o &gt; V i ，则说明1000 0000大了，应将D7 改为0（去码），同时设次高位D6为1。<br>        若V o &lt;V i ，则说明寄存器中的值不够大，故需将D 7 位的1保留（ 加码），同时也设次高位为1 。<br>        再次对输出结果 V o 和 V i 进行比较，确定次高位的1是去掉还是保留。<br>▲ 依此类推，逐位比较，直至最低位，比较完毕后，缓冲寄存器中的数值就是转换结果。</p>
<p>举例： 举例：4.8V （D&#x2F;A 满量程为10V） ）<br>▲ 在启动脉冲 时，逐次逼近寄存器清0。<br>▲ 第1个CLK 到来时，逐次逼近寄存器&#x3D;1000 0000，该值经D&#x2F;A转换后输出V o &#x3D; 128&#x2F;255×10V &#x3D; 5V。<br>                                            5V &gt; 4.8V，说明1000 0000 大了，应将D 7 改为0。<br>▲ 第2个CLK到来时，将逐次逼近寄存器的次高位D6 置1，即 0100 0000 ，该值经D&#x2F;A转换后输出模拟电压V o &#x3D; 64&#x2F;255 ×10V &#x3D; 2.5V。<br>                                         2.5V &lt; 4.8V，说明0100 0000 这个值小了，应该将次高位的1保留。																													▲ 第3个 CLK 到来时，将逐次逼近寄存器的D 5 置1，即0110 0000， 该值经D&#x2F;A转换后输出的模拟电压为V o &#x3D;96&#x2F;255 ×满量程10V &#x3D; 3.75V。<br>                                         3.75V &lt; 4.8V，说明0110 0000这个值仍然小了，应该将D 5 位的1保留。<br>▲ 第4个CLK到来时，将D4 置1，……<br>▲ 重复以上过程，经过8次后，逐次逼近寄存器中的数字量就是转换结果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128185707343.png" alt="image-20221128185707343"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221128185725312.png" alt="image-20221128185725312"></p>
<p>A&#x2F;D转换主要技术指标</p>
<ul>
<li>量化误差：数字量的最低位 1 LSB 的输出变化所对应的 模拟量范围。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130191852827.png" alt="image-20221130191852827"></p>
<ul>
<li><p>分辨率：指A&#x2F;D转换器 所能分辨的最小模拟输入量。或指A&#x2F;D转换器 满量程模拟输入量被分离的级数。</p>
<ul>
<li><p>n位A&#x2F;D转换器应能区分2^n 个不同量级的模拟输入，能区分的输入模拟电压的最小差异为：满量程&#x2F;2^n 。</p>
</li>
<li><p>例：12 位的A&#x2F;D转换器，最大输入模拟信号为 10V，则其分辨率为：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130192026628.png" alt="image-20221130192026628"></p>
</li>
<li><p>可用A&#x2F;D转换器能转换的 数字量位数来表示，例：10位A&#x2F;D转换器的分辨率为10位。</p>
</li>
</ul>
</li>
<li><p>相对精度：指实际转换值偏离理想值的误差，一般用最低有效位来表示。</p>
</li>
<li><p>转换时间：指完成一次转换所需的时间，即：从接到转换启动信号开始，到输出端 获得稳定的数字信号所经过的时间。</p>
</li>
<li><p>转换速率：指实际每秒转换的次数。 注意：转换速率与转换时间不一定是倒数关系（实际大于）。</p>
</li>
</ul>
<h4 id="8-2-2-A-x2F-D转换器接口电路"><a href="#8-2-2-A-x2F-D转换器接口电路" class="headerlink" title="8.2.2 A&#x2F;D转换器接口电路"></a>8.2.2 A&#x2F;D转换器接口电路</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130192153009.png" alt="image-20221130192153009"></p>
<p>Vi：模拟信号输入线，连被转换对象</p>
<p>缓冲寄存器D7~D0：数字信号输出线，连CPU数据总线</p>
<p>转换信号EOC：转换结束 输出线，供中断或CPU查询使用 查询使用</p>
<p>启动信号START：转换启动线</p>
<p>A&#x2F;D 转换器与CPU的接口</p>
<p>①.A&#x2F;D转换启动控制 转换启动控制</p>
<p>▲ D&#x2F;A转换无需启动信号，只要数字量到达转换电路，即可开始转换。而A&#x2F;D转换器每转换一次，都需要CPU发一个启动信号 启动信号Start。<br>▲ 启动分 脉冲启动和 电平启动两种方式。<br>    ☆ 脉冲启动：可由CPU执行写指令时产生的CS 和WR组合 组合得到。启动转换后即可 撤销。例：ADC0804、ADC0809和ADC1210。<br>    ☆ 电平启动：启动信号在整个转换过程中要 保持不变， 中途不能撤销，否则转换停止。CPU可通过 并口产生电平启动信号。例：AD570、AD571和AD572。</p>
<p>②.A&#x2F;D转换结束控制</p>
<p>▲ 转换结束后，A&#x2F;D转换器向外发EOC信号 信号，通知CPU已转换结束。</p>
<p>QES:CPU 读取A&#x2F;D转换结果的 转换结果的 时机问题： ：A&#x2F;D转换时间相对 转换时间相对较长,CPU何时读取才能保证得到正确的结果？</p>
<p><strong>分为以下3种方法来实现</strong></p>
<ul>
<li>固定延迟法<br>▲ 启动转换后，CPU 执行一段延迟程序，确保延迟时间大于A&#x2F;D转换时间，然后再读取转换结果。<br>▲ 特点：不需要应答信号，接口简单，但CPU效率低。</li>
<li>查询等待法<br>▲ 启动转换后，CPU 不断查询EOC 信号状态。一旦发现EOC有效，就读取转换结果。<br>▲ 特点：接口简单，但CPU效率低，延迟时间长。</li>
<li>中断法<br>▲ 转换结束后，由 由EOC 信号触发中断，CPU响应中断，在中断服务程序中读取转换结果。<br>▲ 特点：CPU和A&#x2F;D转换器可并行工作，CPU效率高。</li>
</ul>
<p>③.A&#x2F;D 转换输出控制——缓冲问题</p>
<p>输出允许信号 输出允许信号OE ，它控制数据是否能从A&#x2F;D转换器输出。 转换器输出。一般该信号由 由CPU提供 提供。</p>
<p>▲ 由于A&#x2F;D转换结果与CPU数据总线相连，因此CPU应能 应能控制 何时 转换结果送到总线上， 何时转换结果 被隔离。<br>▲ 若A&#x2F;D转换器内具有三态输出缓冲器，则可 直接通过数据总线与CPU相连。<br>▲ 若A&#x2F;D转换器内无三态输出缓冲器，必须 外接三态缓冲器，以控制输出。</p>
<p>④.A&#x2F;D 转换器输出控制——位数匹配问题</p>
<p>若A&#x2F;D的位数 小于或等于CPU总线宽度，则它可直接与CPU相连，数据 可一次性读入。否则，不能直接相连，数据要 分两次读入。</p>
<p>▲ 情况1：A&#x2F;D的 数据位数大于8位 位，但 数据输出线只有8 根，数据输出分2次完成，芯片有两个数据输出使能信号：高字节使能 高字节使能 (High Byte Enable) 和低字节使能(Low Byte Enable)。<br>        设计接口时，高、低字节输出数据占2个 个不同的端口地址，分2次完成高、低字节的数据读入。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130192933083.png" alt="image-20221130192933083"></p>
<p>▲情况2：ADC数据位数大于8位，数据全部一次性输出。若与8 位CPU相连时，必须外加三态缓冲器 外加三态缓冲器。</p>
<ul>
<li>转换结束后对 CS 1 1 口执行读操作，则12位转换结果全部输出： 低8 8 位直接进入CPU，高8 8 位进入三态锁存器。</li>
<li>然后对 CS 2  口执行读操作，可将高4位数据送入CPU。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130193042110.png" alt="image-20221130193042110"></p>
<h4 id="8-2-3-ADC0809及其应用"><a href="#8-2-3-ADC0809及其应用" class="headerlink" title="8.2.3 ADC0809及其应用"></a>8.2.3 ADC0809及其应用</h4><p>接口功能部分分析：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130193213745.png" alt="image-20221130193213745"></p>
<ol>
<li>输入地址并使得ALE有效，将地址存入锁存寄存器。</li>
<li>地址经译码器选通一路输入到比较器，进行地址的写或者读</li>
<li>从CPU处得到启动信号START </li>
<li>进行A&#x2F;D转换</li>
<li>读取EOC信号查看转换是否完成</li>
<li>当EOC为高时，触发OE（输出使能信号）打开输出锁存器。</li>
</ol>
<p> ADC0809的应用 的应用<br>▲ 内部带三态输出锁存器，与CPU可 直接相连，也可通过8255与CPU相连。<br>▲ 与CPU间的数据传输可采用 查询方式，也可用 中断方式。（EOC）</p>
<h5 id="ADC0809的应用例题"><a href="#ADC0809的应用例题" class="headerlink" title="ADC0809的应用例题"></a>ADC0809的应用例题</h5><p>【例9-5】在8088系统中采用ADC0809设计一个数据采集系统，将第1路模拟量转换为数字量后存储在DATA 1 单元。要求采用 查询方式读取转换结果。</p>
<p>​	硬件电路设计。其中CS 1 对应的端口地址为80<del>87H，CS 2 对应的端口地址为88</del>8FH。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130193616631.png" alt="image-20221130193616631"></p>
<p>①.选中通道1，并启动转换：读or 写？ 地址 ？</p>
<p>​	因为选中第1路信号，且ALE与START由&#x2F;IOW和&#x2F;CS1相与得到，所以在CS1的8个地址中选择1路即A2&#x3D;0,A1&#x3D;0,A0&#x3D;1,81H 为写状态。</p>
<p>②.获取EOC状态。读or 写？地址 ？</p>
<p>​	获取EOC状态，EOC与&#x2F;IOR相连 所以为读信号，还与&#x2F;CS2相连，为了触发&#x2F;CS2，则随便选择88H~8FH中的一个地址 8?H</p>
<p>③.使能OE 读 or 写操作？地址？</p>
<p>​	OE信号与&#x2F;CS1和&#x2F;IOR相连 所以为读操作，读&#x2F;CS1地址中任意一个8?H</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">	OUT 81H，AL ；启动ADC，通道1地址</span><br><span class="line">LL： IN AL，8?H ；读入EOC状态</span><br><span class="line">	AND AL，80H ；测试EOC状态</span><br><span class="line">	JZ LL</span><br><span class="line">	IN AL ，8?H ；OE输出使能，读取结果</span><br><span class="line">	MOV DATA 1 ，AL ；存入指定单元</span><br></pre></td></tr></table></figure>

<p>【例9-6】将例9-5改成 中断方式，要求从通道1读取100个转换后的数据存储在BUFFER数据区。IR 0 的中断类型号为8。8259A中断请求为边沿触发、非自动中断结束方式、普通全嵌套方式。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="C:\Users\林子轩\AppData\Roaming\Typora\typora-user-images\image-20221130194229632.png" alt="image-20221130194229632"></p>
<p>①.全嵌套方式	选中通道1,并启动转换：读or 写？ 地址 ？</p>
<p>​	读操作，读81H地址</p>
<p>②.读数据：读or 写？ 地址 ？</p>
<p>​	读操作，地址为8?H∈{80H~87H}</p>
<p>③.8259 操作地址？</p>
<p>​	为&#x2F;CS2中的某一对奇偶地址</p>
<p>▲ 转换结束后，EOC信号触发中断。 在中断服务程序中CPU 读取转换结果，将之存入Buffer区 区。<br>▲ 主程序的功能：初始化8259、设置中断向量表、开中断、启动A&#x2F;D转换，然后等待中断过程。<br>▲ 中断服务程序功能：读取A&#x2F;D转换结果并将其存入BUFFER、结束中断。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">DATA SEGMENT</span><br><span class="line">	BUFFER DB 100 DUP（？）</span><br><span class="line">DATA ENDS</span><br><span class="line">CODE SEGMENT</span><br><span class="line">	ASSUME CS:CODE，DS:DATA</span><br><span class="line">START：</span><br><span class="line">	MOV AX，0</span><br><span class="line">	MOV DS，AX</span><br><span class="line">	MOV BX，20H ；中断号 ；中断号8*4=32=20H</span><br><span class="line">	MOV DS:[BX]，OFFSET READ_INT ；偏移地址</span><br><span class="line">	MOV AX，SEG READ_INT</span><br><span class="line">	MOV DS:[BX+2]，AX ；段地址</span><br><span class="line">	CLI</span><br><span class="line">	MOV AL，13H ；写 写ICW 1 (边沿触发，单片，需要ICW 4 )</span><br><span class="line">	OUT 88H ，AL</span><br><span class="line">	MOV AL，08H ；写 写ICW 2 (中断号高5位)</span><br><span class="line">	OUT 89H，AL</span><br><span class="line">	MOV AL，01H ；写 写ICW 4 (非缓冲，非EOI，16位机)</span><br><span class="line">	OUT 89H，AL</span><br><span class="line">	IN AL，89H</span><br><span class="line">	AND AL，0FEH</span><br><span class="line">	OUT 89H，AL ；开放 开放IR 0 中断请求</span><br><span class="line">	MOV AX，DATA</span><br><span class="line">	MOV DS，AX</span><br><span class="line">	MOV DI，OFFSET BUFFER ；设置数据区首址</span><br><span class="line">	MOV CX，100 ；采样次数</span><br><span class="line">AGAIN：MOV AL，01H</span><br><span class="line">	OUT 81H ，AL ； 启动转换通道1(CS、WR有效)</span><br><span class="line">	STI ；开中断</span><br><span class="line">	HLT ； 等待中断请求</span><br><span class="line">	CLI ；关中断</span><br><span class="line">	INC DI</span><br><span class="line">	DEC CX ；次数减1</span><br><span class="line">	JNZ AGAIN ；次数未到，继续启动转换</span><br><span class="line">	IN AL，89H ；次数已到，屏蔽 次数已到，屏蔽IR 0</span><br><span class="line">	OR AL，01H</span><br><span class="line">	OUT 89H，AL</span><br><span class="line">	MOV AH，4CH ； 程序结束，返回</span><br><span class="line">	INT 21H</span><br><span class="line">---------------------------------------------以下为中断服务子程序-------------------------------------------------------------------</span><br><span class="line">READ_INT PROC</span><br><span class="line">	PUSH AX ；保护现场</span><br><span class="line">	IN AL，8?H ；从 从ADC0809 通道1读入数据 读入数据</span><br><span class="line">	MOV [DI]，AL ； 将数据存入内存</span><br><span class="line">	MOV AL，20H ；EOI</span><br><span class="line">	OUT 88H，AL</span><br><span class="line">	POP AX</span><br><span class="line">	IRET</span><br><span class="line">READ_INT ENDP</span><br><span class="line">CODE ENDS</span><br><span class="line">END START</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">林子轩</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/12/31/%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E7%AC%94%E8%AE%B0/">http://example.com/2022/12/31/%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E7%AC%94%E8%AE%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Krylistal</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/12/20/liIDW2F3h8XmkHd.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/17/ParticleFilter/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/20/R8Im1dlh5qtEGVw.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Particle filters 论文自读</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/19/%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/20/LkdbQTylPaUChVj.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">第一篇文章</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/20/znl7XLbxSkt2q35.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">林子轩</div><div class="author-info__description">从零开始的博客搭建哦~</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">5</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/krylistal"><i class="fab fa-github"></i><span>前往小屋</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/krylistal" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:2394974737@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E7%AC%94%E8%AE%B0"><span class="toc-text">微机接口笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%BB%AA%E8%AE%BA"><span class="toc-text">第一章 绪论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E5%BE%AE%E6%9C%BA%E4%B8%8E%E6%8E%A5%E5%8F%A3"><span class="toc-text">1.1微机与接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E6%A6%82%E8%BF%B0"><span class="toc-text">1.2微机接口概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E5%BE%AE%E6%9C%BA%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%BB%84%E6%88%90"><span class="toc-text">1.3微机接口的组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4CPU%E4%B8%8E%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2"><span class="toc-text">1.4CPU与接口的数据交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%E7%BB%93%E6%9E%84%E6%8F%90%E7%BA%B2"><span class="toc-text">第一章结构提纲</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-I-x2F-O%E7%AB%AF%E5%8F%A3%E5%9C%B0%E5%9D%80%E8%AF%91%E7%A0%81%E6%8A%80%E6%9C%AF"><span class="toc-text">第二章 I&#x2F;O端口地址译码技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1I-x2F-O%E7%AB%AF%E5%8F%A3%E5%9C%B0%E5%9D%80"><span class="toc-text">2.1I&#x2F;O端口地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2I-x2F-O%E7%AB%AF%E5%8F%A3%E5%9C%B0%E5%9D%80%E5%88%86%E9%85%8D"><span class="toc-text">2.2I&#x2F;O端口地址分配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3I-x2F-O%E7%AB%AF%E5%8F%A3%E5%9C%B0%E5%9D%80%E8%AF%91%E7%A0%81"><span class="toc-text">2.3I&#x2F;O端口地址译码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0%E7%BB%93%E6%9E%84%E6%8F%90%E7%BA%B2"><span class="toc-text">第二章结构提纲</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%AE%9A%E6%97%B6-x2F-%E8%AE%A1%E6%95%B0%E6%8A%80%E6%9C%AF"><span class="toc-text">第三章 定时&#x2F; 计数技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1%E5%AE%9A%E6%97%B6-x2F-%E6%8A%80%E6%9C%AF%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">3.1定时&#x2F;技术基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-8253-x2F-8254%E8%AE%A1%E6%97%B6%E5%99%A8%E5%8F%8A%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-text">3.2  8253&#x2F;8254计时器及工作方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-8253-x2F-8254%E7%BC%96%E7%A8%8B%E4%B8%8E%E5%BA%94%E7%94%A8"><span class="toc-text">3.3 8253&#x2F;8254编程与应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E4%B8%AD%E6%96%AD%E6%8A%80%E6%9C%AF"><span class="toc-text">第五章 中断技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E4%B8%AD%E6%96%AD%E6%8A%80%E6%9C%AF%E6%A6%82%E8%BF%B0"><span class="toc-text">5.1 中断技术概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E4%B8%AD%E6%96%AD%E7%9A%84%E5%B8%B8%E7%94%A8%E6%9C%AF%E8%AF%AD"><span class="toc-text">5.1.1 中断的常用术语</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-%E4%B8%AD%E6%96%AD%E8%BF%87%E7%A8%8B"><span class="toc-text">5.1.2 中断过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-%E4%B8%AD%E6%96%AD%E7%AE%A1%E7%90%86"><span class="toc-text">5.1.3 中断管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-8086-x2F-8088-%E5%BE%AE%E6%9C%BA%E4%B8%AD%E7%9A%84%E7%B3%BB%E7%BB%9F"><span class="toc-text">5.2 8086&#x2F;8088 微机中的系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-%E4%B8%AD%E6%96%AD%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.2.1 中断的类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2-%E4%B8%AD%E6%96%AD%E5%90%91%E9%87%8F%E8%A1%A8"><span class="toc-text">5.2.2 中断向量表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-3%E4%B8%AD%E6%96%AD%E5%90%91%E9%87%8F%E7%9A%84%E8%AE%BE%E7%BD%AE%E4%B8%8E%E4%BF%AE%E6%94%B9"><span class="toc-text">5.2.3中断向量的设置与修改</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-8259A%E5%8F%AF%E7%BC%96%E7%A8%8B%E4%B8%AD%E6%96%AD%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-text">5.3 8259A可编程中断控制器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8259A%E7%BC%96%E7%A8%8B"><span class="toc-text">8259A编程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-8259A%E7%9A%84%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="toc-text">5.4 8259A的应用举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-PC%E6%9C%BA%E4%B8%AD%E7%9A%84%E4%B8%AD%E6%96%AD%E5%BA%94%E7%94%A8"><span class="toc-text">5.5 PC机中的中断应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E5%B9%B6%E8%A1%8C%E6%8E%A5%E5%8F%A3"><span class="toc-text">第六章 并行接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%B9%B6%E8%A1%8C%E6%8E%A5%E5%8F%A3%E6%A6%82%E5%BF%B5"><span class="toc-text">6.1 并行接口概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-8255A%E5%8F%AF%E7%BC%96%E7%A8%8B%E5%B9%B6%E8%A1%8C%E6%8E%A5%E5%8F%A3"><span class="toc-text">6.2 8255A可编程并行接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-8255A%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-text">6.3 8255A的工作方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E4%B8%B2%E8%A1%8C%E9%80%9A%E4%BF%A1%E6%8E%A5%E5%8F%A3"><span class="toc-text">第七章 串行通信接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">7.1 串口通信基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE"><span class="toc-text">7.2 串口通信协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%E6%8E%A5%E5%8F%A3%E6%A0%87%E5%87%86"><span class="toc-text">7.3 串口通信接口标准</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-D-x2F-A%E4%B8%8EA-x2F-D%E8%BD%AC%E6%8D%A2%E5%99%A8"><span class="toc-text">第八章 D&#x2F;A与A&#x2F;D转换器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-D-x2F-A%E8%BD%AC%E6%8D%A2"><span class="toc-text">8.1 D&#x2F;A转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-1-D-x2F-A%E8%BD%AC%E6%8D%A2%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">8.1.1 D&#x2F;A转换工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-2-D-x2F-A%E8%BD%AC%E6%8D%A2%E5%99%A8%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF"><span class="toc-text">8.1.2 D&#x2F;A转换器接口电路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-3-D-x2F-AC0832%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8"><span class="toc-text">8.1.3 D&#x2F;AC0832及其应用</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-A-x2F-D%E8%BD%AC%E6%8D%A2"><span class="toc-text">8.2 A&#x2F;D转换</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-1-A-x2F-D%E8%BD%AC%E6%8D%A2%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-text">8.2.1 A&#x2F;D转换工作原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-2-A-x2F-D%E8%BD%AC%E6%8D%A2%E5%99%A8%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF"><span class="toc-text">8.2.2 A&#x2F;D转换器接口电路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-3-ADC0809%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8"><span class="toc-text">8.2.3 ADC0809及其应用</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ADC0809%E7%9A%84%E5%BA%94%E7%94%A8%E4%BE%8B%E9%A2%98"><span class="toc-text">ADC0809的应用例题</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By 林子轩</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="7341488831" data-server="netease" data-type="playlist" data-order="list" data-fixed="true" data-preload="auto" data-volume=0.7 data-autoplay="false" data-mutex="true" ></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://source.fomal.cc/img/default_cover_43.webp);"> <a class="categoryBar-list-link" href="categories/编译原理/">编译原理</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">这是微机接口</span></li><li class="categoryBar-list-item" style="background:url(https://source.fomal.cc/img/default_cover_44.webp);"> <a class="categoryBar-list-link" href="categories/Spring-boot/">Spring boot</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">玩转Win10</span></li><li class="categoryBar-list-item" style="background:url(https://source.fomal.cc/img/default_cover_45.webp);"> <a class="categoryBar-list-link" href="categories/微机接口/">微机接口</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">长篇小说连载</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>